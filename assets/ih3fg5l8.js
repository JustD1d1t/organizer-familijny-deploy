import{i as J,t as i,N as C,A as t,aN as X,O as o,v as g,x as m,P as E,z as n,b1 as $e,y as L,a9 as De,a5 as K,X as j,a1 as q,B as h,R as V,Q as R,al as ee,ag as xe,_ as Me,aF as ze,L as Y,aE as Be,r as w,G as Te,aR as Qe,Z as Ae,a2 as Oe,l as O,T as Ve,U as Re,S as Ee,V as je,W as qe,a4 as Pe,Y as We,aq as Ne,ar as Fe,a7 as Ue,$ as Ge,b2 as He,b3 as Xe,b4 as Ye}from"./BcoMjeDL.js";import{_ as Ze,a as Je}from"./DqYdSDX0.js";import{_ as Z}from"./DjUJBNEt.js";import{u as Ke}from"./C2S4ZvKu.js";const en={key:0},nn=["src"],tn={class:"flex"},on={class:"my-auto quantity w-5 text-center"},an={__name:"item-counter",props:["quantity","category"],emits:["increaseQuantity","decreaseQuantity"],setup(d,{emit:S}){const k=d,{shoppingItems:b}=Ke(),s=S,_=J(()=>{const p=b.find(f=>f.category===k.category);return p?p.icon:""}),l=()=>{s("increaseQuantity")},I=()=>{s("decreaseQuantity")};return(p,f)=>{const D=K,a=j,x=q;return i(),C(x,{class:"flex items-center"},{default:t(()=>[X(p.$slots,"label"),o(_)?(i(),g("div",en,[m("img",{src:o(_),alt:"category image",class:"w-8 h-8 mr-2"},null,8,nn)])):E("",!0),m("div",tn,[n(a,{onClick:f[0]||(f[0]=()=>I()),size:"small",class:"my-0",type:"tertiary"},{default:t(()=>[n(D,{icon:"ioniconsRemoveOutline"in p?p.ioniconsRemoveOutline:o($e)},null,8,["icon"])]),_:1}),m("span",on,L(d.quantity),1),n(a,{onClick:f[1]||(f[1]=()=>l()),size:"small",class:"my-0",type:"tertiary"},{default:t(()=>[n(D,{icon:"ioniconsAdd"in p?p.ioniconsAdd:o(De)},null,8,["icon"])]),_:1}),X(p.$slots,"actions")])]),_:3})}}},sn={class:"inner-content"},ln={class:"h2 font-bold"},cn={class:"w-full flex justify-between flex-wrap"},rn={__name:"add-shopping-list-modal",props:{name:{type:String,default:()=>""}},emits:["cancelShoppingModal","confirmShoppingModal"],setup(d,{emit:S}){const k=S;return(b,s)=>{const _=j;return i(),g("div",sn,[m("h2",null,[h(" Czy dodać "),m("span",ln,L(d.name),1),h(" do listy zakupowej? ")]),m("div",cn,[n(_,{onClick:s[0]||(s[0]=l=>k("cancelShoppingModal")),color:"alert","data-test":"cancel-button"},{default:t(()=>[h(" Nie ")]),_:1}),n(_,{onClick:s[1]||(s[1]=l=>k("confirmShoppingModal")),color:"success","data-test":"submit-button"},{default:t(()=>[h(" Tak ")]),_:1})])])}}},un={class:"inner-content"},dn=m("h2",null,"wybierz listę zakupową",-1),pn=m("h2",null,"Twoje listy zakupowe",-1),mn={key:0},_n={__name:"select-shopping-list-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}},shoppingLists:{type:Array,default:()=>[]},collaboratedShoppingLists:{type:Array,default:()=>[]}},setup(d){return(S,k)=>{const b=ee,s=q,_=xe;return i(),g("div",un,[dn,n(_,{lines:"none"},{default:t(()=>[pn,(i(!0),g(V,null,R(d.shoppingLists,l=>(i(),C(s,{key:l.id,onClick:I=>d.confirmModal(l)},{default:t(()=>[n(b,null,{default:t(()=>[h(L(l.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),d.collaboratedShoppingLists.length?(i(),g("h2",mn," Listy do których Cię dodano ")):E("",!0),(i(!0),g(V,null,R(d.collaboratedShoppingLists,l=>(i(),C(s,{key:l.id,onClick:I=>d.confirmModal(l)},{default:t(()=>[n(b,null,{default:t(()=>[h(L(l.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},fn={class:"h-full overflow-auto"},yn={key:1},gn={class:"flex flex-col flex-grow"},hn={key:0,class:"text-sm"},vn={__name:"index",setup(d){const S=ze(),{increaseQuantity:k,decreaseQuantity:b}=S,{currentPantry:s}=Y(S),_=Qe(),l=Be(),{getAllShoppingLists:I,updateShoppingList:p}=l,{shoppingLists:f,collaboratedShoppingLists:D}=Y(l),a=w({name:"date",dir:"asc"}),x=J(()=>{var u;const e=((u=s==null?void 0:s.value.items)==null?void 0:u.filter(v=>v.name.toLowerCase().includes(M.value.toLowerCase())))??[];if(e.length){const v=e.filter(c=>c.expiryDate),$=e.filter(c=>!c.expiryDate);if(a.value.name==="date"){if(a.value.dir==="asc")return v.sort((c,y)=>new Date(c.expiryDate)-new Date(y.expiryDate)),[...v,...$];if(a.value.dir==="desc")return v.sort((c,y)=>new Date(y.expiryDate)-new Date(c.expiryDate)),[...v,...$]}else if(a.value.name==="name"){if(a.value.dir==="asc")return e.sort((c,y)=>c.name.localeCompare(y.name));if(a.value.dir==="desc")return e.sort((c,y)=>y.name.localeCompare(c.name))}}return e}),T=w(""),M=w(""),z=w(!1),B=w(!1),ne=w(),te=w(),Q=()=>z.value=!1,A=()=>B.value=!1;Te(_,async(e,u)=>{Q(),A()});const oe=()=>Q(),ae=()=>A(),se=e=>{T.value=e,z.value=!0},ie=async e=>{B.value=!1,await p({...e,items:[...e.items,T.value]}),e.items.push(newItem)},le=async()=>{f.value.length||await I(),z.value=!1,B.value=!0},ce=async e=>{await b(e),e.quantity===1&&se({category:e.category,name:e.name,checked:!1})},re=()=>{O(`/pantries/${s.value.id}/add-item`)},ue=e=>{O(`/pantries/${s.value.id}/${e}`)},de=e=>{O(`/pantries/${s.value.id}/${e.name}`)},pe=e=>e?new Date(e).toLocaleDateString():"",P=e=>{if(a.value!==void 0)if(e!==a.value.name)a.value={name:e,dir:"asc"};else{let u=a.value.dir==="asc"?"desc":"asc";a.value={name:e,dir:u}}else a.value={name:e,dir:"asc"}};return(e,u)=>{const v=Ve,$=Re,c=Ze,y=Je,me=Ee,_e=je,fe=qe,ye=Pe,W=Z,N=ee,F=K,ge=j,he=q,ve=Z,U=We,Se=Ye,ke=an,be=Ne,we=Fe,Le=rn,G=Ue,Ce=_n,Ie=Ae;return i(),C(Ie,null,{default:t(()=>[n(fe,{style:{background:"var(--ion-color-light)"}},{default:t(()=>[n(_e,null,{default:t(()=>[n($,{slot:"start"},{default:t(()=>[n(v,{text:"",icon:"ioniconsArrowBackOutline"in e?e.ioniconsArrowBackOutline:o(Ge)},null,8,["icon"])]),_:1}),n($,{slot:"end"},{default:t(()=>[n(y,{sortId:"pantries-sort",width:"250px"},{default:t(()=>[n(c,{label:"Sortuj po nazwie",onClick:u[0]||(u[0]=r=>P("name")),type:"name",dir:o(a).dir,active:o(a).name==="name"},null,8,["dir","active"]),n(c,{label:"Sortuj po dacie",onClick:u[1]||(u[1]=r=>P("date")),type:"amount",dir:o(a).dir,active:o(a).name==="date"},null,8,["dir","active"])]),_:1})]),_:1}),n(me,null,{default:t(()=>[h("Spiżarnia")]),_:1})]),_:1})]),_:1}),n(U,null,{default:t(()=>[m("div",fn,[m("h2",null,L(o(s).name),1),o(x).length?(i(),C(W,{key:0},{default:t(()=>[n(ye,{label:"Wyszukaj produkt",type:"text",placeholder:"Szukaj...",modelValue:o(M),"onUpdate:modelValue":u[2]||(u[2]=r=>Oe(M)?M.value=r:null)},null,8,["modelValue"])]),_:1})):(i(),g("h2",yn,"Brak produktów w spiżarni")),n(W,{class:"overflow-auto max-h-[75%]"},{default:t(()=>[(i(!0),g(V,null,R(o(x),(r,H)=>(i(),C(ke,{key:r.name,onIncreaseQuantity:()=>o(k)(r),onDecreaseQuantity:()=>ce(r),quantity:r.quantity,category:r.category},{label:t(()=>[m("div",gn,[n(N,{class:"grow my-0",onClick:()=>ue(r.name)},{default:t(()=>[h(L(r.name),1)]),_:2},1032,["onClick"]),r.expiryDate?(i(),g("span",hn,L(pe(r.expiryDate)),1)):E("",!0)])]),actions:t(()=>[n(ge,{type:"tertiary",id:"open-pantry-menu-"+H,class:"ml-auto",size:"small"},{default:t(()=>[n(F,{size:"medium",icon:"ioniconsEllipsisVerticalOutline"in e?e.ioniconsEllipsisVerticalOutline:o(He)},null,8,["icon"])]),_:2},1032,["id"]),n(Se,{trigger:"open-pantry-menu-"+H,"trigger-action":"click",side:"bottom",alignment:"center","dismiss-on-select":!0},{default:t(()=>[n(U,{class:"ion-padding mr-8"},{default:t(()=>[n(ve,null,{default:t(()=>[n(he,null,{default:t(()=>[n(N,{onClick:()=>de(r)},{default:t(()=>[h("Dodaj termin przydatności")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["trigger"])]),_:2},1032,["onIncreaseQuantity","onDecreaseQuantity","quantity","category"]))),128))]),_:1})]),n(we,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:t(()=>[n(be,{onClick:re},{default:t(()=>[n(F,{icon:"ioniconsAddCircle"in e?e.ioniconsAddCircle:o(Xe),size:"large"},null,8,["icon"])]),_:1})]),_:1}),n(G,{class:"auto-height",ref_key:"shoppingModal",ref:ne,"is-open":o(z),onWillDismiss:oe},{default:t(()=>[n(Le,{onCancelShoppingModal:Q,onConfirmShoppingModal:le,name:o(T).name},null,8,["name"])]),_:1},8,["is-open"]),n(G,{class:"auto-height",ref_key:"selectShoppingListModal",ref:te,"is-open":o(B),onWillDismiss:ae},{default:t(()=>[n(Ce,{cancel:A,"confirm-modal":ie,shoppingLists:o(f),collaboratedShoppingLists:o(D)},null,8,["shoppingLists","collaboratedShoppingLists"])]),_:1},8,["is-open"])]),_:1})]),_:1})}}},Ln=Me(vn,[["__scopeId","data-v-562b7d73"]]);export{Ln as default};
