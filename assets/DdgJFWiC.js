import{i as K,t as i,N as L,A as t,aL as X,P as o,v as g,x as m,Q as j,z as n,a$ as Ie,y as C,a6 as De,a0 as Y,T as q,Z as E,B as h,R as O,S as R,ae as ee,$ as xe,_ as Me,aC as Be,M as Z,aB as ze,r as w,G as Qe,aQ as Te,a5 as Ae,aq as Ve,l as V,ad as Oe,U as Re,a2 as je,V as qe,W as Ee,X as Pe,a4 as We,am as Ne,an as Fe,a1 as Ue,af as Ge,b0 as He,b1 as Xe,b2 as Ze}from"./DRa_VBAG.js";import{_ as Je,a as Ke}from"./BsGTiNlx.js";import{_ as J}from"./B0difAmE.js";import{u as Ye}from"./YQiM4Bel.js";const en={key:0},nn=["src"],tn={class:"flex"},on={class:"my-auto quantity w-5 text-center"},an={__name:"item-counter",props:["quantity","category"],emits:["increaseQuantity","decreaseQuantity"],setup(d,{emit:S}){const k=d,{shoppingItems:b}=Ye(),s=S,_=K(()=>{const p=b.find(f=>f.category===k.category);return p?p.icon:""}),l=()=>{s("increaseQuantity")},$=()=>{s("decreaseQuantity")};return(p,f)=>{const D=Y,a=q,x=E;return i(),L(x,{class:"flex items-center"},{default:t(()=>[X(p.$slots,"label"),o(_)?(i(),g("div",en,[m("img",{src:o(_),alt:"category image",class:"w-8 h-8 mr-2"},null,8,nn)])):j("",!0),m("div",tn,[n(a,{onClick:f[0]||(f[0]=()=>$()),size:"small",class:"my-0",type:"tertiary"},{default:t(()=>[n(D,{icon:"ioniconsRemoveOutline"in p?p.ioniconsRemoveOutline:o(Ie)},null,8,["icon"])]),_:1}),m("span",on,C(d.quantity),1),n(a,{onClick:f[1]||(f[1]=()=>l()),size:"small",class:"my-0",type:"tertiary"},{default:t(()=>[n(D,{icon:"ioniconsAdd"in p?p.ioniconsAdd:o(De)},null,8,["icon"])]),_:1}),X(p.$slots,"actions")])]),_:3})}}},sn={class:"inner-content"},ln={class:"h2 font-bold"},cn={class:"w-full flex justify-between flex-wrap"},rn={__name:"add-shopping-list-modal",props:{name:{type:String,default:()=>""}},emits:["cancelShoppingModal","confirmShoppingModal"],setup(d,{emit:S}){const k=S;return(b,s)=>{const _=q;return i(),g("div",sn,[m("h2",null,[h(" Czy dodać "),m("span",ln,C(d.name),1),h(" do listy zakupowej? ")]),m("div",cn,[n(_,{onClick:s[0]||(s[0]=l=>k("cancelShoppingModal")),color:"alert","data-test":"cancel-button"},{default:t(()=>[h(" Nie ")]),_:1}),n(_,{onClick:s[1]||(s[1]=l=>k("confirmShoppingModal")),color:"success","data-test":"submit-button"},{default:t(()=>[h(" Tak ")]),_:1})])])}}},un={class:"inner-content"},dn=m("h2",null,"wybierz listę zakupową",-1),pn=m("h2",null,"Twoje listy zakupowe",-1),mn={key:0},_n={__name:"select-shopping-list-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}},shoppingLists:{type:Array,default:()=>[]},collaboratedShoppingLists:{type:Array,default:()=>[]}},setup(d){return(S,k)=>{const b=ee,s=E,_=xe;return i(),g("div",un,[dn,n(_,{lines:"none"},{default:t(()=>[pn,(i(!0),g(O,null,R(d.shoppingLists,l=>(i(),L(s,{key:l.id,onClick:$=>d.confirmModal(l)},{default:t(()=>[n(b,null,{default:t(()=>[h(C(l.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),d.collaboratedShoppingLists.length?(i(),g("h2",mn," Listy do których Cię dodano ")):j("",!0),(i(!0),g(O,null,R(d.collaboratedShoppingLists,l=>(i(),L(s,{key:l.id,onClick:$=>d.confirmModal(l)},{default:t(()=>[n(b,null,{default:t(()=>[h(C(l.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},fn={class:"h-full overflow-auto"},yn={key:1},gn={class:"flex flex-col flex-grow"},hn={key:0,class:"text-sm"},vn={__name:"index",setup(d){const S=Be(),{increaseQuantity:k,decreaseQuantity:b}=S,{currentPantry:s}=Z(S),_=Te(),l=ze(),{getAllShoppingLists:$,updateShoppingList:p}=l,{shoppingLists:f,collaboratedShoppingLists:D}=Z(l),a=w({name:"date",dir:"asc"}),x=K(()=>{var u;const e=((u=s==null?void 0:s.value.items)==null?void 0:u.filter(v=>v.name.toLowerCase().includes(M.value.toLowerCase())))??[];if(e.length){const v=e.filter(c=>c.expiryDate),I=e.filter(c=>!c.expiryDate);if(a.value.name==="date"){if(a.value.dir==="asc")return v.sort((c,y)=>new Date(c.expiryDate)-new Date(y.expiryDate)),[...v,...I];if(a.value.dir==="desc")return v.sort((c,y)=>new Date(y.expiryDate)-new Date(c.expiryDate)),[...v,...I]}else if(a.value.name==="name"){if(a.value.dir==="asc")return e.sort((c,y)=>c.name.localeCompare(y.name));if(a.value.dir==="desc")return e.sort((c,y)=>y.name.localeCompare(c.name))}}return e}),Q=w(""),M=w(""),B=w(!1),z=w(!1),ne=w(),te=w(),T=()=>B.value=!1,A=()=>z.value=!1;Qe(_,async(e,u)=>{T(),A()});const oe=()=>T(),ae=()=>A(),se=e=>{Q.value=e,B.value=!0},ie=async e=>{z.value=!1,await p({...e,items:[...e.items,Q.value]}),e.items.push(newItem)},le=async()=>{f.value.length||await $(),B.value=!1,z.value=!0},ce=async e=>{await b(e),e.quantity===1&&se({category:e.category,name:e.name,checked:!1})},re=()=>{V(`/pantries/${s.value.id}/add-item`)},ue=e=>{V(`/pantries/${s.value.id}/${e}`)},de=e=>{V(`/pantries/${s.value.id}/${e.name}`)},pe=e=>e?new Date(e).toLocaleDateString():"",P=e=>{if(a.value!==void 0)if(e!==a.value.name)a.value={name:e,dir:"asc"};else{let u=a.value.dir==="asc"?"desc":"asc";a.value={name:e,dir:u}}else a.value={name:e,dir:"asc"}};return(e,u)=>{const v=Oe,I=Re,c=Je,y=Ke,me=je,_e=qe,fe=Ee,ye=Pe,W=J,N=ee,F=Y,ge=q,he=E,ve=J,U=We,Se=Ze,ke=an,be=Ne,we=Fe,Ce=rn,G=Ue,Le=_n,$e=Ae;return i(),L($e,null,{default:t(()=>[n(fe,{style:{background:"var(--ion-color-light)"}},{default:t(()=>[n(_e,null,{default:t(()=>[n(I,{slot:"start"},{default:t(()=>[n(v,{text:"",icon:"ioniconsArrowBackOutline"in e?e.ioniconsArrowBackOutline:o(Ge)},null,8,["icon"])]),_:1}),n(I,{slot:"end"},{default:t(()=>[n(y,{sortId:"pantries-sort",width:"250px"},{default:t(()=>[n(c,{label:"Sortuj po nazwie",onClick:u[0]||(u[0]=r=>P("name")),type:"name",dir:o(a).dir,active:o(a).name==="name"},null,8,["dir","active"]),n(c,{label:"Sortuj po dacie",onClick:u[1]||(u[1]=r=>P("date")),type:"amount",dir:o(a).dir,active:o(a).name==="date"},null,8,["dir","active"])]),_:1})]),_:1}),n(me,null,{default:t(()=>[h("Spiżarnia")]),_:1})]),_:1})]),_:1}),n(U,null,{default:t(()=>[m("div",fn,[m("h2",null,C(o(s).name),1),o(x).length?(i(),L(W,{key:0},{default:t(()=>[n(ye,{label:"Wyszukaj produkt",type:"text",placeholder:"Szukaj...",modelValue:o(M),"onUpdate:modelValue":u[2]||(u[2]=r=>Ve(M)?M.value=r:null)},null,8,["modelValue"])]),_:1})):(i(),g("h2",yn,"Brak produktów w spiżarni")),n(W,{class:"overflow-auto max-h-[75%]"},{default:t(()=>[(i(!0),g(O,null,R(o(x),(r,H)=>(i(),L(ke,{key:r.name,onIncreaseQuantity:()=>o(k)(r),onDecreaseQuantity:()=>ce(r),quantity:r.quantity,category:r.category},{label:t(()=>[m("div",gn,[n(N,{class:"grow my-0",onClick:()=>ue(r.name)},{default:t(()=>[h(C(r.name),1)]),_:2},1032,["onClick"]),r.expiryDate?(i(),g("span",hn,C(pe(r.expiryDate)),1)):j("",!0)])]),actions:t(()=>[n(ge,{type:"tertiary",id:"open-pantry-menu-"+H,class:"ml-auto",size:"small"},{default:t(()=>[n(F,{size:"medium",icon:"ioniconsEllipsisVerticalOutline"in e?e.ioniconsEllipsisVerticalOutline:o(He)},null,8,["icon"])]),_:2},1032,["id"]),n(Se,{trigger:"open-pantry-menu-"+H,"trigger-action":"click",side:"bottom",alignment:"center","dismiss-on-select":!0},{default:t(()=>[n(U,{class:"ion-padding mr-8"},{default:t(()=>[n(ve,null,{default:t(()=>[n(he,null,{default:t(()=>[n(N,{onClick:()=>de(r)},{default:t(()=>[h("Dodaj termin przydatności")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["trigger"])]),_:2},1032,["onIncreaseQuantity","onDecreaseQuantity","quantity","category"]))),128))]),_:1})]),n(we,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:t(()=>[n(be,{onClick:re},{default:t(()=>[n(F,{icon:"ioniconsAddCircle"in e?e.ioniconsAddCircle:o(Xe),size:"large"},null,8,["icon"])]),_:1})]),_:1}),n(G,{class:"auto-height",ref_key:"shoppingModal",ref:ne,"is-open":o(B),onWillDismiss:oe},{default:t(()=>[n(Ce,{onCancelShoppingModal:T,onConfirmShoppingModal:le,name:o(Q).name},null,8,["name"])]),_:1},8,["is-open"]),n(G,{class:"auto-height",ref_key:"selectShoppingListModal",ref:te,"is-open":o(z),onWillDismiss:ae},{default:t(()=>[n(Le,{cancel:A,"confirm-modal":ie,shoppingLists:o(f),collaboratedShoppingLists:o(D)},null,8,["shoppingLists","collaboratedShoppingLists"])]),_:1},8,["is-open"])]),_:1})]),_:1})}}},Cn=Me(vn,[["__scopeId","data-v-562b7d73"]]);export{Cn as default};
