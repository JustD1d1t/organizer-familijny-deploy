import{t as n,N as f,A as s,z as t,B as w,y as R,P as e,Q as P,aK as O,aa as F,Z as N,at as M,i as I,x as B,v as y,aF as q,l as K,aW as ge,T as ye,_ as W,aA as fe,M as j,R as C,S as A,$ as U,aP as he,aO as ve,au as E,r as D,a2 as ke,a8 as Ie,U as Se,a7 as Ce,V as be,W as $e,a0 as Le,af as Ae,ag as Be,a1 as xe}from"./Ba9MK0Qe.js";import{m as we,t as Re,a as ze,i as De}from"./CHVAF33P.js";import{_ as Pe,a as Te,b as Me}from"./e3KN0yBK.js";import{_ as Oe}from"./DlVjWr08.js";import{u as Ne}from"./ClHQf6gd.js";const Fe={__name:"PopoverItem",props:{label:{type:String,default:""},active:{type:Boolean,default:!1}},setup(c){return(h,l)=>{const p=O,o=F,r=N;return n(),f(r,null,{default:s(()=>[t(p,null,{default:s(()=>[w(R(c.label),1)]),_:1}),c.active?(n(),f(o,{key:0,slot:"end",icon:"ioniconsCheckmarkOutline"in h?h.ioniconsCheckmarkOutline:e(we)},null,8,["icon"])):P("",!0)]),_:1})}}},We={__name:"sort-and-filter",props:{layout:{type:String,required:!0},dir:{type:String,required:!0},nameDir:{type:String,required:!0},lastSort:{type:String,required:!0}},emits:["changeLayout","sortByCategory","sortByName","openPantryModal","removeAllItems","removeSelectedItems","selectAllItems","deselectAllItems"],setup(c,{emit:h}){const l=h;return(p,o)=>{const r=Fe,g=Pe,m=Te;return n(),f(m,{sortId:"shopping-list-sort"},{default:s(()=>[t(r,{onClick:o[0]||(o[0]=a=>l("changeLayout","category")),label:"Widok kategorii",active:c.layout==="category"},null,8,["active"]),t(r,{onClick:o[1]||(o[1]=a=>l("changeLayout","products")),label:"Widok produktów",active:c.layout==="products"},null,8,["active"]),t(g,{label:"Sortuj po kategorii",onClick:o[2]||(o[2]=a=>l("sortByCategory")),type:"amount",dir:c.dir,active:c.lastSort==="category"},null,8,["dir","active"]),t(g,{label:"Sortuj po nazwie",onClick:o[3]||(o[3]=a=>l("sortByName")),type:"amount",dir:c.nameDir,active:c.lastSort==="name"},null,8,["dir","active"]),t(r,{onClick:o[4]||(o[4]=a=>l("openPantryModal")),label:"Dodaj zaznaczone produkty do spiżarni"}),t(r,{onClick:o[5]||(o[5]=a=>l("removeAllItems")),label:`Usuń wszystkie\r
        produkty`}),t(r,{onClick:o[6]||(o[6]=a=>l("removeSelectedItems")),label:"Usuń zakupione produkty"}),t(r,{onClick:o[7]||(o[7]=a=>l("selectAllItems")),label:"Zaznacz wszystkie produkty"}),t(r,{onClick:o[8]||(o[8]=a=>l("deselectAllItems")),label:"Odznacz wszystkie produkty"})]),_:1})}}},je={class:"flex flex-col grow ml-4"},Ue={class:"text-base"},He={class:"text-xs"},Ve={key:0},qe=["src"],Z={__name:"item",props:{item:{type:Object,default:()=>{}}},setup(c){const{shoppingItems:h}=Ne(),l=c,p=M(),{removeItem:o,handleItemChange:r}=p,g=I(()=>{const m=h.find(a=>a.category===l.item.category);return m?m.icon:""});return(m,a)=>{const u=Oe;return n(),f(u,{item:l.item,"handle-item-change":()=>e(r)(l.item),removeItem:()=>e(o)(c.item)},{label:s(()=>[B("div",je,[B("span",Ue,R(c.item.name),1),B("span",He,R(c.item.category),1)]),e(g)?(n(),y("div",Ve,[B("img",{src:e(g),alt:"category image",class:"w-8 h-8 mr-2"},null,8,qe)])):P("",!0)]),_:1},8,["item","handle-item-change","removeItem"])}}},G={__name:"recipe",props:{recipe:{type:Object,default:()=>{}},recipes:{type:Array,default:()=>[]}},setup(c){const h=M(),{setCurrentRecipe:l,removeRecipe:p,handleRecipeChange:o}=h,r=q(),g=c,m=I(()=>g.recipe.ingredients.every(u=>u.checked)),a=u=>{K(`/shopping-lists/${r.params.id}/recipe/${u}`),l(g.recipe)};return(u,i)=>{const d=ge,_=O,v=F,b=ye,L=N;return n(),f(L,{class:"border-0"},{default:s(()=>[t(d,{slot:"start",class:"mr-0","aria-label":"Toggle task completion",onIonChange:i[0]||(i[0]=z=>e(o)(z.detail.checked,g.recipe)),checked:e(m)},null,8,["checked"]),t(_,{class:"border-0 grow ml-4",onClick:i[1]||(i[1]=()=>a(c.recipe.id))},{default:s(()=>[w(R(c.recipe.name),1)]),_:1}),t(b,{slot:"end",onClick:i[2]||(i[2]=()=>e(p)(g.recipe.id)),size:"small",fill:"clear"},{default:s(()=>[t(v,{icon:"ioniconsTrash"in u?u.ioniconsTrash:e(Re)},null,8,["icon"])]),_:1})]),_:1})}}},Ke={};function Ee(c,h){return n(),y("span",null,[fe(c.$slots,"default",{},void 0,!0)])}const Q=W(Ke,[["render",Ee],["__scopeId","data-v-a302f0dd"]]),Ze={key:1},Ge={__name:"products",props:{nameDir:{type:String,default:""},dir:{type:String,default:""},lastSort:{type:String,default:""}},setup(c){const h=M(),l=c,{currentShoppingList:p}=j(h),o=I(()=>p?p.value.items:[]),r=I(()=>p.value?p.value.recipes:[]),g=I(()=>{if(o.value){let d=[...o.value];return l.lastSort==="category"?d=d.sort((_,v)=>l.dir==="asc"?_.category.localeCompare(v.category):v.category.localeCompare(_.category)):l.lastSort==="name"&&(d=d.sort((_,v)=>l.nameDir==="asc"?_.name.localeCompare(v.name):v.name.localeCompare(_.name))),d}return[]}),m=I(()=>g.value.filter(d=>!d.checked)),a=I(()=>g.value.filter(d=>d.checked)),u=I(()=>r.value.filter(d=>d.ingredients.every(_=>!_.checked))),i=I(()=>r.value.filter(d=>d.ingredients.every(_=>_.checked)));return(d,_)=>{const v=Z,b=G,L=Me,z=Q,S=U;return n(),y(C,null,[e(m).length||e(u).length?(n(),f(L,{key:0},{default:s(()=>[(n(!0),y(C,null,A(e(m),k=>(n(),f(v,{key:k,item:k},null,8,["item"]))),128)),(n(!0),y(C,null,A(e(u),k=>(n(),f(b,{key:k.id,recipe:k,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})):P("",!0),e(a).length||e(i).length?(n(),y("div",Ze,[t(z,null,{default:s(()=>[w("Kupione")]),_:1}),t(S,{inset:!0,class:"overflow-auto py-2"},{default:s(()=>[(n(!0),y(C,null,A(e(a),k=>(n(),f(v,{key:k,item:k},null,8,["item"]))),128)),(n(!0),y(C,null,A(e(i),k=>(n(),f(b,{key:k.id,recipe:k,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})])):P("",!0)],64)}}},Qe=W(Ge,[["__scopeId","data-v-08f51cd6"]]),Je={class:"ion-padding",slot:"content"},Xe={key:0},Ye={__name:"sorted-by-category",setup(c){const h=M(),{handleItemChange:l,removeItem:p}=h,{currentShoppingList:o}=j(h);I(()=>o.value?o.value.items:[]);const r=I(()=>o.value?o.value.recipes:[]),g=I(()=>{const m={};return o.value.items.forEach(a=>{m[a.category]||(m[a.category]={checked:[],unchecked:[]}),a.checked?m[a.category].checked.push(a):m[a.category].unchecked.push(a)}),m});return(m,a)=>{const u=O,i=N,d=Z,_=U,v=Q,b=he,L=ve,z=G;return n(),y(C,null,[t(L,null,{default:s(()=>[(n(!0),y(C,null,A(e(g),(S,k)=>(n(),f(b,{key:k,value:S},{default:s(()=>[t(i,{slot:"header",color:"light"},{default:s(()=>[t(u,null,{default:s(()=>[w(R(k),1)]),_:2},1024)]),_:2},1024),B("div",Je,[t(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(n(!0),y(C,null,A(S.unchecked,$=>(n(),f(d,{key:$,item:$,onRemoveItem:()=>e(p)($),onHandleItemChange:()=>e(l)($)},null,8,["item","onRemoveItem","onHandleItemChange"]))),128))]),_:2},1024),S.checked.length?(n(),y("div",Xe,[t(v,null,{default:s(()=>[w("Kupione")]),_:1}),t(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(n(!0),y(C,null,A(S.checked,$=>(n(),f(d,{key:$,item:$,onRemoveItem:()=>e(p)($),onHandleItemChange:()=>e(l)($)},null,8,["item","onRemoveItem","onHandleItemChange"]))),128))]),_:2},1024)])):P("",!0)])]),_:2},1032,["value"]))),128))]),_:1}),t(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(n(!0),y(C,null,A(e(r),S=>(n(),f(z,{key:S.id,recipe:S,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})],64)}}},et=W(Ye,[["__scopeId","data-v-9565374f"]]),tt={class:"inner-content"},nt=B("h2",null,"wybierz spiżarnię",-1),ot=B("h2",null,"Twoje spiżarnie",-1),st={key:0},at={__name:"select-pantry-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}}},setup(c){const h=E(),{pantries:l,collaboratedPantries:p}=h;return(o,r)=>{const g=O,m=N,a=U;return n(),y("div",tt,[nt,t(a,{lines:"none"},{default:s(()=>[ot,(n(!0),y(C,null,A(e(l),u=>(n(),f(m,{key:u.id,onClick:i=>c.confirmModal(u)},{default:s(()=>[t(g,null,{default:s(()=>[w(R(u.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),e(p)&&e(p).length?(n(),y("h2",st," Spiżarnie do których Cię dodano ")):P("",!0),(n(!0),y(C,null,A(e(p),u=>(n(),f(m,{key:u.id,onClick:i=>c.confirmModal(u)},{default:s(()=>[t(g,null,{default:s(()=>[w(R(u.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},lt={class:"h-[90%]"},ct={key:0},it={key:1},pt={__name:"index",setup(c){const h=q(),l=E(),{handlePantryItemsFromShoppingList:p}=l,o=M(),{updateShoppingList:r,removeAllItems:g,selectAllItems:m,deselectAllItems:a,removeSelectedItems:u}=o,{currentShoppingList:i}=j(o),d=D("products"),_=D("asc"),v=D("asc"),b=D(""),L=D(!1),z=D(),S=()=>L.value=!1,k=async x=>{const H=i.value.items.filter(T=>T.checked);i.value.items=i.value.items.filter(T=>!T.checked),await p(H,x),await r({...i.value,items:i.value.items}),L.value=!1},$=I(()=>i!=null&&i.value?i.value.name:""),J=()=>{_.value=_.value==="asc"?"desc":"asc",b.value="category"},X=()=>{v.value=v.value==="asc"?"desc":"asc",b.value="name"},Y=x=>{d.value=x},ee=()=>{K(`/shopping-lists/${h.params.id}/add-item`)},te=()=>{L.value=!0};return(x,H)=>{const T=Ie,V=Se,ne=Ce,oe=We,se=be,ae=$e,le=Qe,ce=et,ie=at,re=Le,ue=F,de=Ae,me=Be,_e=xe,pe=ke;return n(),f(pe,null,{default:s(()=>[t(ae,{style:{background:"var(--ion-color-light)"}},{default:s(()=>[t(se,null,{default:s(()=>[t(V,{slot:"start"},{default:s(()=>[t(T,{text:"",icon:"ioniconsArrowBackOutline"in x?x.ioniconsArrowBackOutline:e(ze)},null,8,["icon"])]),_:1}),t(ne,null,{default:s(()=>[w("Listy zakupowe")]),_:1}),t(V,{slot:"end"},{default:s(()=>[t(oe,{layout:e(d),dir:e(_),nameDir:e(v),lastSort:e(b),onChangeLayout:Y,onSortByCategory:J,onSortByName:X,onOpenPantryModal:te,onRemoveAllItems:e(g),onRemoveSelectedItems:e(u),onSelectAllItems:e(m),onDeselectAllItems:e(a)},null,8,["layout","dir","nameDir","lastSort","onRemoveAllItems","onRemoveSelectedItems","onSelectAllItems","onDeselectAllItems"])]),_:1})]),_:1})]),_:1}),t(_e,null,{default:s(()=>[B("div",lt,[B("h2",null,R(e($)),1),e(i).items.length||e(i).recipes.length?(n(),y("div",ct,[e(d)=="products"?(n(),f(le,{key:0,dir:e(_),nameDir:e(v),lastSort:e(b)},null,8,["dir","nameDir","lastSort"])):(n(),f(ce,{key:1}))])):(n(),y("h3",it,"Brak produktów na liście")),t(re,{class:"auto-height",ref_key:"modal",ref:z,"is-open":e(L),onWillDismiss:S},{default:s(()=>[t(ie,{cancel:S,confirmModal:k})]),_:1},8,["is-open"]),t(me,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:s(()=>[t(de,{onClick:ee},{default:s(()=>[t(ue,{icon:"ioniconsAddCircle"in x?x.ioniconsAddCircle:e(De),size:"large"},null,8,["icon"])]),_:1})]),_:1})])]),_:1})]),_:1})}}};export{pt as default};
