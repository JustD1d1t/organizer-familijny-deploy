import{_ as E,ac as G,L as H,aQ as M,r as s,i as W,G as Q,o as X,N as Y,A as n,aR as Z,aS as q,Z as J,t as K,z as t,O as ee,B as g,aT as I,aU as S,x as l,y as C,aV as te,T as ae,U as ne,S as oe,V as se,W as re,ao as ce,a1 as le,X as ie,ag as ue,Y as de,$ as _e,C as pe,D as fe,ad as ve}from"./9W-cnvgg.js";import{_ as me,S as he,a as we}from"./BvO9hB1Q.js";const ge=u=>(pe("data-v-ba6e4db5"),u=u(),fe(),u),ke={class:"w-full flex flex-col justify-center items-center h-full"},ye=ge(()=>l("span",null,"ładowanie gazetki",-1)),xe={class:"text-base"},be={class:"w-[100%] flex justify-between items-center"},Ie={__name:"index",setup(u){const{backendUrl:B}=ve(),P=G(),{idToken:T}=H(P);me.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const k=Z(),F=k.params.id,j=M(he.Newspapers,()=>[]),D=s(1),r=s(1),_=s(0),y=s(""),p=s(null),d=s(null),i=s(!1),f=s(!1),x=W(()=>j.value[F]),R=async a=>{try{f.value=!0,i.value=!0;const e=T.value;return(await te.post(`${B}/html/pdfFromLinks`,{imgs:a},{responseType:"arraybuffer",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}})).data}catch(e){throw i.value=!1,console.error("Error fetching content:",e),e}},U=async()=>{try{const a=await R(x.value.imgs),e=new Uint8Array(a);we({data:e}).promise.then(o=>{d.value=o,_.value=d.value.numPages,v(r.value)}).catch(o=>{alert("Failed to load PDF: "+o.message)})}catch(a){alert("Failed to load PDF: "+a.message)}},z=()=>{r.value>1&&(r.value--,v(r.value))},A=()=>{r.value<_.value&&(r.value++,v(r.value))},v=async a=>{if(!(!d.value||!f.value))try{const e=await q(d.value).getPage(a),c=e.getViewport({scale:D.value}),o=document.createElement("canvas"),m=o.getContext("2d");o.width=c.width,o.height=c.height;const h={canvasContext:m,viewport:c};await e.render(h).promise,o.style.width="100%",p.value.innerHTML="",p.value.appendChild(o),i.value=!1,y.value=`Strona ${a} z ${_.value}`}catch(e){alert("Failed to render page: "+e.message)}};return Q(k,async(a,e)=>{f.value=!1}),X(()=>{U()}),(a,e)=>{const c=ae,o=ne,m=oe,h=se,N=re,V=ce,w=le,b=ie,L=ue,O=de,$=J;return K(),Y($,null,{default:n(()=>[t(N,{style:{background:"var(--ion-color-light)"}},{default:n(()=>[t(h,null,{default:n(()=>[t(o,{slot:"start"},{default:n(()=>[t(c,{text:"",icon:"ioniconsArrowBackOutline"in a?a.ioniconsArrowBackOutline:ee(_e)},null,8,["icon"])]),_:1}),t(m,null,{default:n(()=>[g("Gazetki")]),_:1})]),_:1})]),_:1}),t(O,null,{default:n(()=>[I(l("div",ke,[t(V,{name:"lines-sharp"}),ye],512),[[S,i.value]]),I(l("div",null,[t(L,{lines:"none"},{default:n(()=>[t(w,null,{default:n(()=>[l("h1",xe,C(x.value.title),1)]),_:1}),t(w,{class:"canvas"},{default:n(()=>[l("div",{ref_key:"pagesContainer",ref:p,class:"w-[100%]"},null,512)]),_:1}),t(w,null,{default:n(()=>[l("div",be,[t(b,{type:"tertiary",onClick:z},{default:n(()=>[g(" Poprzednia ")]),_:1}),l("span",null,C(y.value),1),t(b,{type:"tertiary",onClick:A},{default:n(()=>[g("Następna")]),_:1})])]),_:1})]),_:1})],512),[[S,!i.value]])]),_:1})]),_:1})}}},Pe=E(Ie,[["__scopeId","data-v-ba6e4db5"]]);export{Pe as default};
