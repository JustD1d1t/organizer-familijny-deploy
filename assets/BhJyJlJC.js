import{_ as $,aN as E,r as s,i as G,G as L,o as H,N as M,A as n,aO as W,aP as Q,a5 as Z,t as q,z as e,P as J,B as g,aQ as b,aR as C,x as r,y as P,aS as K,ac as X,U as Y,a2 as ee,V as ae,W as te,aj as ne,Z as oe,T as se,$ as le,a4 as re,ae as ce,C as ie,D as ue,ax as _e}from"./BClyMcC6.js";import{_ as pe,S as de,a as fe}from"./B-A1t5Hk.js";const ve=u=>(ie("data-v-e9e91a7f"),u=u(),ue(),u),me={class:"w-full flex flex-col justify-center items-center h-full"},we=ve(()=>r("span",null,"ładowanie gazetki",-1)),he={class:"text-base"},ge={class:"w-[100%] flex justify-between items-center"},xe={__name:"index",setup(u){const{backendUrl:S}=_e();pe.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const x=W(),B=x.params.id,T=E(de.Newspapers,()=>[]),j=s(1),l=s(1),p=s(0),y=s(""),d=s(null),_=s(null),i=s(!1),f=s(!1),k=G(()=>T.value[B]),D=async a=>{try{return f.value=!0,i.value=!0,(await K.get(`${S}/html/pdf`,{params:{url:a},responseType:"arraybuffer"})).data}catch(t){throw i.value=!1,console.error("Error fetching content:",t),t}},F=async()=>{try{const a=await D(k.value.url),t=new Uint8Array(a);fe({data:t}).promise.then(o=>{_.value=o,p.value=_.value.numPages,v(l.value)}).catch(o=>{alert("Failed to load PDF: "+o.message)})}catch(a){alert("Failed to load PDF: "+a.message)}},N=()=>{l.value>1&&(l.value--,v(l.value))},R=()=>{l.value<p.value&&(l.value++,v(l.value))},v=async a=>{if(!(!_.value||!f.value))try{const t=await Q(_.value).getPage(a),c=t.getViewport({scale:j.value}),o=document.createElement("canvas"),m=o.getContext("2d");o.width=c.width,o.height=c.height;const w={canvasContext:m,viewport:c};await t.render(w).promise,o.style.width="100%",d.value.innerHTML="",d.value.appendChild(o),i.value=!1,y.value=`Strona ${a} z ${p.value}`}catch(t){alert("Failed to render page: "+t.message)}};return L(x,async(a,t)=>{f.value=!1}),H(()=>{F()}),(a,t)=>{const c=X,o=Y,m=ee,w=ae,z=te,A=ne,h=oe,I=se,O=le,U=re,V=Z;return q(),M(V,null,{default:n(()=>[e(z,{style:{background:"var(--ion-color-light)"}},{default:n(()=>[e(w,null,{default:n(()=>[e(o,{slot:"start"},{default:n(()=>[e(c,{text:"",icon:"ioniconsArrowBackOutline"in a?a.ioniconsArrowBackOutline:J(ce)},null,8,["icon"])]),_:1}),e(m,null,{default:n(()=>[g("Gazetki")]),_:1})]),_:1})]),_:1}),e(U,null,{default:n(()=>[b(r("div",me,[e(A,{name:"lines-sharp"}),we],512),[[C,i.value]]),b(r("div",null,[e(O,{lines:"none"},{default:n(()=>[e(h,null,{default:n(()=>[r("h1",he,P(k.value.title),1)]),_:1}),e(h,{class:"canvas"},{default:n(()=>[r("div",{ref_key:"pagesContainer",ref:d,class:"w-[100%]"},null,512)]),_:1}),e(h,null,{default:n(()=>[r("div",ge,[e(I,{type:"tertiary",onClick:N},{default:n(()=>[g(" Poprzednia ")]),_:1}),r("span",null,P(y.value),1),e(I,{type:"tertiary",onClick:R},{default:n(()=>[g("Następna")]),_:1})])]),_:1})]),_:1})],512),[[C,!i.value]])]),_:1})]),_:1})}}},be=$(xe,[["__scopeId","data-v-e9e91a7f"]]);export{be as default};
