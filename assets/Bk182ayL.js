import{_ as G,aD as O,r as s,i as $,G as H,o as L,N as M,A as n,aE as W,aF as Z,a2 as q,t as J,z as e,P as K,B as g,aG as b,aH as C,x as l,y as P,aI as Q,a8 as X,U as Y,a7 as ee,V as ae,W as te,ae as ne,Z as oe,T as se,$ as re,a1 as le,C as ce,D as ie,ar as ue}from"./USmwVBIr.js";import{a as _e}from"./CHVAF33P.js";import{_ as pe,S as de,a as fe}from"./C8ASzTgT.js";const ve=u=>(ce("data-v-e9e91a7f"),u=u(),ie(),u),me={class:"w-full flex flex-col justify-center items-center h-full"},we=ve(()=>l("span",null,"ładowanie gazetki",-1)),he={class:"text-base"},ge={class:"w-[100%] flex justify-between items-center"},ye={__name:"index",setup(u){const{backendUrl:S}=ue();pe.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const y=W(),B=y.params.id,D=O(de.Newspapers,()=>[]),F=s(1),r=s(1),p=s(0),k=s(""),d=s(null),_=s(null),i=s(!1),f=s(!1),x=$(()=>D.value[B]),T=async a=>{try{return f.value=!0,i.value=!0,(await Q.get(`${S}/html/pdf`,{params:{url:a},responseType:"arraybuffer"})).data}catch(t){throw i.value=!1,console.error("Error fetching content:",t),t}},j=async()=>{try{const a=await T(x.value.url),t=new Uint8Array(a);fe({data:t}).promise.then(o=>{_.value=o,p.value=_.value.numPages,v(r.value)}).catch(o=>{alert("Failed to load PDF: "+o.message)})}catch(a){alert("Failed to load PDF: "+a.message)}},N=()=>{r.value>1&&(r.value--,v(r.value))},z=()=>{r.value<p.value&&(r.value++,v(r.value))},v=async a=>{if(!(!_.value||!f.value))try{const t=await Z(_.value).getPage(a),c=t.getViewport({scale:F.value}),o=document.createElement("canvas"),m=o.getContext("2d");o.width=c.width,o.height=c.height;const w={canvasContext:m,viewport:c};await t.render(w).promise,o.style.width="100%",d.value.innerHTML="",d.value.appendChild(o),i.value=!1,k.value=`Strona ${a} z ${p.value}`}catch(t){alert("Failed to render page: "+t.message)}};return H(y,async(a,t)=>{f.value=!1}),L(()=>{j()}),(a,t)=>{const c=X,o=Y,m=ee,w=ae,A=te,R=ne,h=oe,I=se,U=re,V=le,E=q;return J(),M(E,null,{default:n(()=>[e(A,{style:{background:"var(--ion-color-light)"}},{default:n(()=>[e(w,null,{default:n(()=>[e(o,{slot:"start"},{default:n(()=>[e(c,{text:"",icon:"ioniconsArrowBackOutline"in a?a.ioniconsArrowBackOutline:K(_e)},null,8,["icon"])]),_:1}),e(m,null,{default:n(()=>[g("Gazetki")]),_:1})]),_:1})]),_:1}),e(V,null,{default:n(()=>[b(l("div",me,[e(R,{name:"lines-sharp"}),we],512),[[C,i.value]]),b(l("div",null,[e(U,{lines:"none"},{default:n(()=>[e(h,null,{default:n(()=>[l("h1",he,P(x.value.title),1)]),_:1}),e(h,{class:"canvas"},{default:n(()=>[l("div",{ref_key:"pagesContainer",ref:d,class:"w-[100%]"},null,512)]),_:1}),e(h,null,{default:n(()=>[l("div",ge,[e(I,{type:"tertiary",onClick:N},{default:n(()=>[g(" Poprzednia ")]),_:1}),l("span",null,P(k.value),1),e(I,{type:"tertiary",onClick:z},{default:n(()=>[g("Następna")]),_:1})])]),_:1})]),_:1})],512),[[C,!i.value]])]),_:1})]),_:1})}}},Ce=G(ye,[["__scopeId","data-v-e9e91a7f"]]);export{Ce as default};
