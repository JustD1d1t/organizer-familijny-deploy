import{t,N as y,A as s,z as n,B as w,y as D,O as e,bo as ge,P as z,al as M,a5 as F,a1 as N,aD as O,i as I,x as A,v as h,aS as H,a8 as he,l as V,bp as ye,X as fe,_ as E,aO as ve,L as j,R as C,Q as B,ag as U,aF as ke,aG as Ie,aE as G,r as P,Z as Se,T as Ce,U as be,S as $e,V as Le,W as Be,a7 as Ae,aq as xe,ar as we,Y as De,$ as Re,b3 as ze}from"./B0ZLNBRr.js";import{_ as Pe,a as Te}from"./DlkC2NoW.js";import{_ as Oe}from"./BwiQYEJy.js";import{u as Me}from"./ZxR0iDOO.js";import{_ as Ne}from"./JAm2dq49.js";const Fe={__name:"PopoverItem",props:{label:{type:String,default:""},active:{type:Boolean,default:!1}},setup(c){return(f,l)=>{const p=M,o=F,r=N;return t(),y(r,null,{default:s(()=>[n(p,null,{default:s(()=>[w(D(c.label),1)]),_:1}),c.active?(t(),y(o,{key:0,slot:"end",icon:"ioniconsCheckmarkOutline"in f?f.ioniconsCheckmarkOutline:e(ge)},null,8,["icon"])):z("",!0)]),_:1})}}},je={__name:"sort-and-filter",props:{layout:{type:String,required:!0},dir:{type:String,required:!0},nameDir:{type:String,required:!0},lastSort:{type:String,required:!0}},emits:["changeLayout","sortByCategory","sortByName","openPantryModal","removeAllItems","removeSelectedItems","selectAllItems","deselectAllItems"],setup(c,{emit:f}){const l=f;return(p,o)=>{const r=Fe,g=Pe,m=Te;return t(),y(m,{sortId:"shopping-list-sort"},{default:s(()=>[n(r,{onClick:o[0]||(o[0]=a=>l("changeLayout","category")),label:"Widok kategorii",active:c.layout==="category"},null,8,["active"]),n(r,{onClick:o[1]||(o[1]=a=>l("changeLayout","products")),label:"Widok produktów",active:c.layout==="products"},null,8,["active"]),n(g,{label:"Sortuj po kategorii",onClick:o[2]||(o[2]=a=>l("sortByCategory")),type:"amount",dir:c.dir,active:c.lastSort==="category"},null,8,["dir","active"]),n(g,{label:"Sortuj po nazwie",onClick:o[3]||(o[3]=a=>l("sortByName")),type:"amount",dir:c.nameDir,active:c.lastSort==="name"},null,8,["dir","active"]),n(r,{onClick:o[4]||(o[4]=a=>l("openPantryModal")),label:"Dodaj zaznaczone produkty do spiżarni"}),n(r,{onClick:o[5]||(o[5]=a=>l("removeAllItems")),label:`Usuń wszystkie\r
        produkty`}),n(r,{onClick:o[6]||(o[6]=a=>l("removeSelectedItems")),label:"Usuń zakupione produkty"}),n(r,{onClick:o[7]||(o[7]=a=>l("selectAllItems")),label:"Zaznacz wszystkie produkty"}),n(r,{onClick:o[8]||(o[8]=a=>l("deselectAllItems")),label:"Odznacz wszystkie produkty"})]),_:1})}}},Ue={class:"flex flex-col grow ml-4"},We={class:"text-base"},qe={class:"text-xs"},He={key:0},Ve=["src"],K={__name:"item",props:{item:{type:Object,default:()=>{}}},setup(c){const{shoppingItems:f}=Me(),l=c,p=O(),{removeItem:o,handleItemChange:r}=p,g=I(()=>{const m=f.find(a=>a.category===l.item.category);return m?m.icon:""});return(m,a)=>{const u=Oe;return t(),y(u,{item:l.item,"handle-item-change":()=>e(r)(l.item),removeItem:()=>e(o)(c.item)},{label:s(()=>[A("div",Ue,[A("span",We,D(c.item.name),1),A("span",qe,D(c.item.category),1)]),e(g)?(t(),h("div",He,[A("img",{src:e(g),alt:"category image",class:"w-8 h-8 mr-2"},null,8,Ve)])):z("",!0)]),_:1},8,["item","handle-item-change","removeItem"])}}},Z={__name:"recipe",props:{recipe:{type:Object,default:()=>{}},recipes:{type:Array,default:()=>[]}},setup(c){const f=O(),{setCurrentRecipe:l,removeRecipe:p,handleRecipeChange:o}=f,r=H(),g=c,m=I(()=>g.recipe.ingredients.every(u=>u.checked)),a=u=>{V(`/shopping-lists/${r.params.id}/recipe/${u}`),l(g.recipe)};return(u,i)=>{const d=ye,_=M,v=F,b=fe,L=N;return t(),y(L,{class:"border-0"},{default:s(()=>[n(d,{slot:"start",class:"mr-0","aria-label":"Toggle task completion",onIonChange:i[0]||(i[0]=R=>e(o)(R.detail.checked,g.recipe)),checked:e(m)},null,8,["checked"]),n(_,{class:"border-0 grow ml-4",onClick:i[1]||(i[1]=()=>a(c.recipe.id))},{default:s(()=>[w(D(c.recipe.name),1)]),_:1}),n(b,{slot:"end",onClick:i[2]||(i[2]=()=>e(p)(g.recipe.id)),size:"small",type:"tertiary"},{default:s(()=>[n(v,{icon:"ioniconsTrash"in u?u.ioniconsTrash:e(he)},null,8,["icon"])]),_:1})]),_:1})}}},Ee={};function Ge(c,f){return t(),h("span",null,[ve(c.$slots,"default",{},void 0,!0)])}const Q=E(Ee,[["render",Ge],["__scopeId","data-v-a302f0dd"]]),Ke={key:1},Ze={__name:"products",props:{nameDir:{type:String,default:""},dir:{type:String,default:""},lastSort:{type:String,default:""}},setup(c){const f=O(),l=c,{currentShoppingList:p}=j(f),o=I(()=>p?p.value.items:[]),r=I(()=>p.value?p.value.recipes:[]),g=I(()=>{if(o.value){let d=[...o.value];return l.lastSort==="category"?d=d.sort((_,v)=>l.dir==="asc"?_.category.localeCompare(v.category):v.category.localeCompare(_.category)):l.lastSort==="name"&&(d=d.sort((_,v)=>l.nameDir==="asc"?_.name.localeCompare(v.name):v.name.localeCompare(_.name))),d}return[]}),m=I(()=>g.value.filter(d=>!d.checked)),a=I(()=>g.value.filter(d=>d.checked)),u=I(()=>r.value.filter(d=>d.ingredients.every(_=>!_.checked))),i=I(()=>r.value.filter(d=>d.ingredients.every(_=>_.checked)));return(d,_)=>{const v=K,b=Z,L=Ne,R=Q,S=U;return t(),h(C,null,[e(m).length||e(u).length?(t(),y(L,{key:0,lines:!0},{default:s(()=>[(t(!0),h(C,null,B(e(m),k=>(t(),y(v,{key:k,item:k},null,8,["item"]))),128)),(t(!0),h(C,null,B(e(u),k=>(t(),y(b,{key:k.id,recipe:k,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})):z("",!0),e(a).length||e(i).length?(t(),h("div",Ke,[n(R,null,{default:s(()=>[w("Kupione")]),_:1}),n(S,{inset:!0,class:"overflow-auto py-0"},{default:s(()=>[(t(!0),h(C,null,B(e(a),k=>(t(),y(v,{key:k,item:k},null,8,["item"]))),128)),(t(!0),h(C,null,B(e(i),k=>(t(),y(b,{key:k.id,recipe:k,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})])):z("",!0)],64)}}},Qe=E(Ze,[["__scopeId","data-v-1f8eb9fb"]]),Xe={class:"ion-padding",slot:"content"},Ye={key:0},Je={__name:"sorted-by-category",setup(c){const f=O(),{handleItemChange:l,removeItem:p}=f,{currentShoppingList:o}=j(f);I(()=>o.value?o.value.items:[]);const r=I(()=>o.value?o.value.recipes:[]),g=I(()=>{const m={};return o.value.items.forEach(a=>{m[a.category]||(m[a.category]={checked:[],unchecked:[]}),a.checked?m[a.category].checked.push(a):m[a.category].unchecked.push(a)}),m});return(m,a)=>{const u=M,i=N,d=K,_=U,v=Q,b=ke,L=Ie,R=Z;return t(),h(C,null,[n(L,null,{default:s(()=>[(t(!0),h(C,null,B(e(g),(S,k)=>(t(),y(b,{key:k,value:S},{default:s(()=>[n(i,{slot:"header",color:"light"},{default:s(()=>[n(u,null,{default:s(()=>[w(D(k),1)]),_:2},1024)]),_:2},1024),A("div",Xe,[n(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(t(!0),h(C,null,B(S.unchecked,$=>(t(),y(d,{key:$,item:$,onRemoveItem:()=>e(p)($),onHandleItemChange:()=>e(l)($)},null,8,["item","onRemoveItem","onHandleItemChange"]))),128))]),_:2},1024),S.checked.length?(t(),h("div",Ye,[n(v,null,{default:s(()=>[w("Kupione")]),_:1}),n(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(t(!0),h(C,null,B(S.checked,$=>(t(),y(d,{key:$,item:$,onRemoveItem:()=>e(p)($),onHandleItemChange:()=>e(l)($)},null,8,["item","onRemoveItem","onHandleItemChange"]))),128))]),_:2},1024)])):z("",!0)])]),_:2},1032,["value"]))),128))]),_:1}),n(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(t(!0),h(C,null,B(e(r),S=>(t(),y(R,{key:S.id,recipe:S,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})],64)}}},et={class:"inner-content"},tt=A("h2",null,"wybierz spiżarnię",-1),nt=A("h2",null,"Twoje spiżarnie",-1),ot={key:0},st={__name:"select-pantry-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}}},setup(c){const f=G(),{pantries:l,collaboratedPantries:p}=f;return(o,r)=>{const g=M,m=N,a=U;return t(),h("div",et,[tt,n(a,{lines:"none"},{default:s(()=>[nt,(t(!0),h(C,null,B(e(l),u=>(t(),y(m,{key:u.id,onClick:i=>c.confirmModal(u)},{default:s(()=>[n(g,null,{default:s(()=>[w(D(u.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),e(p)&&e(p).length?(t(),h("h2",ot," Spiżarnie do których Cię dodano ")):z("",!0),(t(!0),h(C,null,B(e(p),u=>(t(),y(m,{key:u.id,onClick:i=>c.confirmModal(u)},{default:s(()=>[n(g,null,{default:s(()=>[w(D(u.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},at={class:"h-[90%]"},lt={class:"h1"},ct={key:0},it={key:1},pt={__name:"index",setup(c){const f=H(),l=G(),{handlePantryItemsFromShoppingList:p}=l,o=O(),{updateShoppingList:r,removeAllItems:g,selectAllItems:m,deselectAllItems:a,removeSelectedItems:u}=o,{currentShoppingList:i}=j(o),d=P("products"),_=P("asc"),v=P("asc"),b=P(""),L=P(!1),R=P(),S=()=>L.value=!1,k=async x=>{const W=i.value.items.filter(T=>T.checked);i.value.items=i.value.items.filter(T=>!T.checked),await p(W,x),await r({...i.value,items:i.value.items}),L.value=!1},$=I(()=>i!=null&&i.value?i.value.name:""),X=()=>{_.value=_.value==="asc"?"desc":"asc",b.value="category"},Y=()=>{v.value=v.value==="asc"?"desc":"asc",b.value="name"},J=x=>{d.value=x},ee=()=>{V(`/shopping-lists/${f.params.id}/add-item`)},te=()=>{L.value=!0};return(x,W)=>{const T=Ce,q=be,ne=$e,oe=je,se=Le,ae=Be,le=Qe,ce=Je,ie=st,re=Ae,ue=F,de=xe,me=we,_e=De,pe=Se;return t(),y(pe,null,{default:s(()=>[n(ae,{style:{background:"var(--ion-color-light)"}},{default:s(()=>[n(se,null,{default:s(()=>[n(q,{slot:"start"},{default:s(()=>[n(T,{text:"",icon:"ioniconsArrowBackOutline"in x?x.ioniconsArrowBackOutline:e(Re)},null,8,["icon"])]),_:1}),n(ne,null,{default:s(()=>[w("Listy zakupowe")]),_:1}),e(i).items.length||e(i).recipes.length?(t(),y(q,{key:0,slot:"end"},{default:s(()=>[n(oe,{layout:e(d),dir:e(_),nameDir:e(v),lastSort:e(b),onChangeLayout:J,onSortByCategory:X,onSortByName:Y,onOpenPantryModal:te,onRemoveAllItems:e(g),onRemoveSelectedItems:e(u),onSelectAllItems:e(m),onDeselectAllItems:e(a)},null,8,["layout","dir","nameDir","lastSort","onRemoveAllItems","onRemoveSelectedItems","onSelectAllItems","onDeselectAllItems"])]),_:1})):z("",!0)]),_:1})]),_:1}),n(_e,null,{default:s(()=>[A("div",at,[A("h2",lt,D(e($)),1),e(i).items.length||e(i).recipes.length?(t(),h("div",ct,[e(d)=="products"?(t(),y(le,{key:0,dir:e(_),nameDir:e(v),lastSort:e(b)},null,8,["dir","nameDir","lastSort"])):(t(),y(ce,{key:1}))])):(t(),h("h3",it,"Brak produktów na liście")),n(re,{class:"auto-height",ref_key:"modal",ref:R,"is-open":e(L),onWillDismiss:S},{default:s(()=>[n(ie,{cancel:S,confirmModal:k})]),_:1},8,["is-open"]),n(me,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:s(()=>[n(de,{onClick:ee},{default:s(()=>[n(ue,{icon:"ioniconsAddCircle"in x?x.ioniconsAddCircle:e(ze),size:"large"},null,8,["icon"])]),_:1})]),_:1})])]),_:1})]),_:1})}}};export{pt as default};
