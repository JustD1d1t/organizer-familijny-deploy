import{i as J,t as r,N as C,A as t,ay as X,P as o,v,x as m,Q as B,z as n,y as w,a9 as K,T as P,Y as j,B as g,R,S as E,aI as Z,ae as ee,_ as De,as as $e,M as Y,ar as xe,r as I,G as Me,aD as ze,a1 as Te,ah as Be,l as V,a7 as Qe,U as Ae,a6 as Oe,V as Ve,W as Re,X as Ee,a0 as Pe,af as je,ag as qe,$ as We,aO as Ne}from"./DO8NUlkj.js";import{_ as Fe,a as Ue,b as Ge}from"./unGQwd3K.js";import{u as He}from"./BqjzI2aC.js";import{r as Xe,d as Ye,a as Je,h as Ke,i as Ze}from"./CQt0DnLH.js";const en={key:0},nn=["src"],tn={class:"flex"},on={class:"my-auto quantity w-5 text-center"},an={__name:"item-counter",props:["quantity","category"],emits:["increaseQuantity","decreaseQuantity"],setup(d,{emit:S}){const k=d,{shoppingItems:b}=He(),s=S,_=J(()=>{const p=b.find(f=>f.category===k.category);return p?p.icon:""}),i=()=>{s("increaseQuantity")},L=()=>{s("decreaseQuantity")};return(p,f)=>{const $=K,a=P,x=j;return r(),C(x,{class:"flex items-center"},{default:t(()=>[X(p.$slots,"label"),o(_)?(r(),v("div",en,[m("img",{src:o(_),alt:"category image",class:"w-8 h-8 mr-2"},null,8,nn)])):B("",!0),m("div",tn,[n(a,{onClick:f[0]||(f[0]=()=>L()),size:"small",class:"my-0",fill:"clear"},{default:t(()=>[n($,{icon:"ioniconsRemoveOutline"in p?p.ioniconsRemoveOutline:o(Xe)},null,8,["icon"])]),_:1}),m("span",on,w(d.quantity),1),n(a,{onClick:f[1]||(f[1]=()=>i()),size:"small",class:"my-0",fill:"clear"},{default:t(()=>[n($,{icon:"ioniconsAdd"in p?p.ioniconsAdd:o(Ye)},null,8,["icon"])]),_:1}),X(p.$slots,"actions")])]),_:3})}}},sn={class:"inner-content"},ln={"data-test":"test-name"},cn={class:"w-full flex justify-between flex-wrap"},rn={__name:"add-shopping-list-modal",props:{name:{type:String,default:()=>""}},emits:["cancelShoppingModal","confirmShoppingModal"],setup(d,{emit:S}){const k=S;return(b,s)=>{const _=P;return r(),v("div",sn,[m("h2",null,[g(" Czy dodać "),m("span",ln,w(d.name),1),g(" do listy zakupowej? ")]),m("div",cn,[n(_,{onClick:s[0]||(s[0]=i=>k("cancelShoppingModal")),color:"danger","data-test":"cancel-button"},{default:t(()=>[g("Nie")]),_:1}),n(_,{onClick:s[1]||(s[1]=i=>k("confirmShoppingModal")),color:"success","data-test":"submit-button"},{default:t(()=>[g("Tak")]),_:1})])])}}},un={class:"inner-content"},dn=m("h2",null,"wybierz listę zakupową",-1),pn=m("h2",null,"Twoje listy zakupowe",-1),mn={key:0},_n={__name:"select-shopping-list-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}},shoppingLists:{type:Array,default:()=>[]},collaboratedShoppingLists:{type:Array,default:()=>[]}},setup(d){return(S,k)=>{const b=Z,s=j,_=ee;return r(),v("div",un,[dn,n(_,{lines:"none"},{default:t(()=>[pn,(r(!0),v(R,null,E(d.shoppingLists,i=>(r(),C(s,{key:i.id,onClick:L=>d.confirmModal(i)},{default:t(()=>[n(b,null,{default:t(()=>[g(w(i.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),d.collaboratedShoppingLists.length?(r(),v("h2",mn," Listy do których Cię dodano ")):B("",!0),(r(!0),v(R,null,E(d.collaboratedShoppingLists,i=>(r(),C(s,{key:i.id,onClick:L=>d.confirmModal(i)},{default:t(()=>[n(b,null,{default:t(()=>[g(w(i.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},fn={class:"h-full overflow-auto"},yn={class:"flex flex-col flex-grow"},gn={key:0,class:"text-sm"},hn={__name:"index",setup(d){const S=$e(),{increaseQuantity:k,decreaseQuantity:b}=S,{currentPantry:s}=Y(S),_=ze(),i=xe(),{getAllShoppingLists:L,updateShoppingList:p}=i,{shoppingLists:f,collaboratedShoppingLists:$}=Y(i),a=I({name:"date",dir:"asc"}),x=J(()=>{var u;const e=((u=s==null?void 0:s.value.items)==null?void 0:u.filter(h=>h.name.toLowerCase().includes(M.value.toLowerCase())))??[];if(e.length){const h=e.filter(l=>l.expiryDate),D=e.filter(l=>!l.expiryDate);if(a.value.name==="date"){if(a.value.dir==="asc")return h.sort((l,y)=>new Date(l.expiryDate)-new Date(y.expiryDate)),[...h,...D];if(a.value.dir==="desc")return h.sort((l,y)=>new Date(y.expiryDate)-new Date(l.expiryDate)),[...h,...D]}else if(a.value.name==="name"){if(a.value.dir==="asc")return e.sort((l,y)=>l.name.localeCompare(y.name));if(a.value.dir==="desc")return e.sort((l,y)=>y.name.localeCompare(l.name))}}return e}),Q=I(""),M=I(""),z=I(!1),T=I(!1),ne=I(),te=I(),A=()=>z.value=!1,O=()=>T.value=!1;Me(_,async(e,u)=>{A(),O()});const oe=()=>A(),ae=()=>O(),se=e=>{Q.value=e,z.value=!0},ie=async e=>{T.value=!1,await p({...e,items:[...e.items,Q.value]}),e.items.push(newItem)},le=async()=>{f.value.length||await L(),z.value=!1,T.value=!0},ce=async e=>{await b(e),e.quantity===1&&se({category:e.category,name:e.name,checked:!1})},re=()=>{V(`/pantries/${s.value.id}/add-item`)},ue=e=>{V(`/pantries/${s.value.id}/${e}`)},de=e=>{V(`/pantries/${s.value.id}/${e.name}`)},pe=e=>e?new Date(e).toLocaleDateString():"",q=e=>{if(a.value!==void 0)if(e!==a.value.name)a.value={name:e,dir:"asc"};else{let u=a.value.dir==="asc"?"desc":"asc";a.value={name:e,dir:u}}else a.value={name:e,dir:"asc"}};return(e,u)=>{const h=Qe,D=Ae,l=Fe,y=Ue,me=Oe,_e=Ve,fe=Re,ye=Ee,W=j,N=Z,F=K,ge=P,he=ee,U=Pe,ve=Ne,Se=an,ke=Ge,be=je,Ie=qe,we=rn,G=We,Ce=_n,Le=Te;return r(),C(Le,null,{default:t(()=>[n(fe,null,{default:t(()=>[n(_e,{translucent:!0},{default:t(()=>[n(D,{slot:"start"},{default:t(()=>[n(h,{text:"",icon:"ioniconsArrowBackOutline"in e?e.ioniconsArrowBackOutline:o(Je)},null,8,["icon"])]),_:1}),n(D,{slot:"end"},{default:t(()=>[n(y,{sortId:"pantries-sort",width:"250px"},{default:t(()=>[n(l,{label:"Sortuj po nazwie",onClick:u[0]||(u[0]=c=>q("name")),type:"name",dir:o(a).dir,active:o(a).name==="name"},null,8,["dir","active"]),n(l,{label:"Sortuj po dacie",onClick:u[1]||(u[1]=c=>q("date")),type:"amount",dir:o(a).dir,active:o(a).name==="date"},null,8,["dir","active"])]),_:1})]),_:1}),n(me,null,{default:t(()=>[g("Spiżarnia")]),_:1})]),_:1})]),_:1}),n(U,null,{default:t(()=>[m("div",fn,[m("h2",null,w(o(s).name),1),n(W,{class:"mb-4"},{default:t(()=>[n(ye,{"data-test":"shop-input",label:"Szukaj...","label-placement":"floating",ref:"shopInput",class:"shopInput",type:"text",modelValue:o(M),"onUpdate:modelValue":u[2]||(u[2]=c=>Be(M)?M.value=c:null)},null,8,["modelValue"])]),_:1}),o(x).length?(r(),C(ke,{key:0,class:"overflow-auto max-h-[75%]"},{default:t(()=>[(r(!0),v(R,null,E(o(x),(c,H)=>(r(),C(Se,{key:c.name,onIncreaseQuantity:()=>o(k)(c),onDecreaseQuantity:()=>ce(c),quantity:c.quantity,category:c.category},{label:t(()=>[m("div",yn,[n(N,{class:"grow my-0",onClick:()=>ue(c.name)},{default:t(()=>[g(w(c.name),1)]),_:2},1032,["onClick"]),c.expiryDate?(r(),v("span",gn,w(pe(c.expiryDate)),1)):B("",!0)])]),actions:t(()=>[n(ge,{fill:"clear",id:"open-pantry-menu-"+H,class:"ml-auto",size:"small"},{default:t(()=>[n(F,{size:"medium",icon:"ioniconsEllipsisVerticalOutline"in e?e.ioniconsEllipsisVerticalOutline:o(Ke)},null,8,["icon"])]),_:2},1032,["id"]),n(ve,{trigger:"open-pantry-menu-"+H,"trigger-action":"click",side:"bottom",alignment:"center","dismiss-on-select":!0},{default:t(()=>[n(U,{class:"ion-padding mr-8"},{default:t(()=>[n(he,null,{default:t(()=>[n(W,null,{default:t(()=>[n(N,{onClick:()=>de(c)},{default:t(()=>[g("Dodaj termin przydatności")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["trigger"])]),_:2},1032,["onIncreaseQuantity","onDecreaseQuantity","quantity","category"]))),128))]),_:1})):B("",!0)]),n(Ie,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:t(()=>[n(be,{onClick:re},{default:t(()=>[n(F,{icon:"ioniconsAddCircle"in e?e.ioniconsAddCircle:o(Ze),size:"large"},null,8,["icon"])]),_:1})]),_:1}),n(G,{class:"auto-height",ref_key:"shoppingModal",ref:ne,"is-open":o(z),onWillDismiss:oe},{default:t(()=>[n(we,{onCancelShoppingModal:A,onConfirmShoppingModal:le,name:o(Q).name},null,8,["name"])]),_:1},8,["is-open"]),n(G,{class:"auto-height",ref_key:"selectShoppingListModal",ref:te,"is-open":o(T),onWillDismiss:ae},{default:t(()=>[n(Ce,{cancel:O,"confirm-modal":ie,shoppingLists:o(f),collaboratedShoppingLists:o($)},null,8,["shoppingLists","collaboratedShoppingLists"])]),_:1},8,["is-open"])]),_:1})]),_:1})}}},In=De(hn,[["__scopeId","data-v-1e86d030"]]);export{In as default};
