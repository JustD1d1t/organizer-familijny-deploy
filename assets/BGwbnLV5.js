import{t as n,N as h,A as s,z as t,B as w,y as R,P as e,Q as P,aJ as O,aa as j,Z as N,at as M,i as I,x as B,v as y,aE as H,l as q,aV as ge,T as ye,_ as E,aA as he,M as F,R as C,S as A,$ as U,aO as fe,aN as ve,au as K,r as D,a2 as ke,a8 as Ie,U as Se,a7 as Ce,V as be,W as $e,a0 as Le,af as Ae,ag as Be,a1 as xe}from"./BVzA7Ocv.js";import{m as we,t as Re,a as ze,i as De}from"./CHVAF33P.js";import{_ as Pe,a as Te}from"./BYtEUTs5.js";import{_ as Me}from"./D3V8bRM-.js";import{u as Oe}from"./Cnzi7RKO.js";import{_ as Ne}from"./CXi93bau.js";const je={__name:"PopoverItem",props:{label:{type:String,default:""},active:{type:Boolean,default:!1}},setup(c){return(f,l)=>{const p=O,o=j,r=N;return n(),h(r,null,{default:s(()=>[t(p,null,{default:s(()=>[w(R(c.label),1)]),_:1}),c.active?(n(),h(o,{key:0,slot:"end",icon:"ioniconsCheckmarkOutline"in f?f.ioniconsCheckmarkOutline:e(we)},null,8,["icon"])):P("",!0)]),_:1})}}},Fe={__name:"sort-and-filter",props:{layout:{type:String,required:!0},dir:{type:String,required:!0},nameDir:{type:String,required:!0},lastSort:{type:String,required:!0}},emits:["changeLayout","sortByCategory","sortByName","openPantryModal","removeAllItems","removeSelectedItems","selectAllItems","deselectAllItems"],setup(c,{emit:f}){const l=f;return(p,o)=>{const r=je,g=Pe,m=Te;return n(),h(m,{sortId:"shopping-list-sort"},{default:s(()=>[t(r,{onClick:o[0]||(o[0]=a=>l("changeLayout","category")),label:"Widok kategorii",active:c.layout==="category"},null,8,["active"]),t(r,{onClick:o[1]||(o[1]=a=>l("changeLayout","products")),label:"Widok produktów",active:c.layout==="products"},null,8,["active"]),t(g,{label:"Sortuj po kategorii",onClick:o[2]||(o[2]=a=>l("sortByCategory")),type:"amount",dir:c.dir,active:c.lastSort==="category"},null,8,["dir","active"]),t(g,{label:"Sortuj po nazwie",onClick:o[3]||(o[3]=a=>l("sortByName")),type:"amount",dir:c.nameDir,active:c.lastSort==="name"},null,8,["dir","active"]),t(r,{onClick:o[4]||(o[4]=a=>l("openPantryModal")),label:"Dodaj zaznaczone produkty do spiżarni"}),t(r,{onClick:o[5]||(o[5]=a=>l("removeAllItems")),label:`Usuń wszystkie\r
        produkty`}),t(r,{onClick:o[6]||(o[6]=a=>l("removeSelectedItems")),label:"Usuń zakupione produkty"}),t(r,{onClick:o[7]||(o[7]=a=>l("selectAllItems")),label:"Zaznacz wszystkie produkty"}),t(r,{onClick:o[8]||(o[8]=a=>l("deselectAllItems")),label:"Odznacz wszystkie produkty"})]),_:1})}}},Ue={class:"flex flex-col grow ml-4"},We={class:"text-base"},Ve={class:"text-xs"},He={key:0},qe=["src"],Z={__name:"item",props:{item:{type:Object,default:()=>{}}},setup(c){const{shoppingItems:f}=Oe(),l=c,p=M(),{removeItem:o,handleItemChange:r}=p,g=I(()=>{const m=f.find(a=>a.category===l.item.category);return m?m.icon:""});return(m,a)=>{const u=Me;return n(),h(u,{item:l.item,"handle-item-change":()=>e(r)(l.item),removeItem:()=>e(o)(c.item)},{label:s(()=>[B("div",Ue,[B("span",We,R(c.item.name),1),B("span",Ve,R(c.item.category),1)]),e(g)?(n(),y("div",He,[B("img",{src:e(g),alt:"category image",class:"w-8 h-8 mr-2"},null,8,qe)])):P("",!0)]),_:1},8,["item","handle-item-change","removeItem"])}}},G={__name:"recipe",props:{recipe:{type:Object,default:()=>{}},recipes:{type:Array,default:()=>[]}},setup(c){const f=M(),{setCurrentRecipe:l,removeRecipe:p,handleRecipeChange:o}=f,r=H(),g=c,m=I(()=>g.recipe.ingredients.every(u=>u.checked)),a=u=>{q(`/shopping-lists/${r.params.id}/recipe/${u}`),l(g.recipe)};return(u,i)=>{const d=ge,_=O,v=j,b=ye,L=N;return n(),h(L,{class:"border-0"},{default:s(()=>[t(d,{slot:"start",class:"mr-0","aria-label":"Toggle task completion",onIonChange:i[0]||(i[0]=z=>e(o)(z.detail.checked,g.recipe)),checked:e(m)},null,8,["checked"]),t(_,{class:"border-0 grow ml-4",onClick:i[1]||(i[1]=()=>a(c.recipe.id))},{default:s(()=>[w(R(c.recipe.name),1)]),_:1}),t(b,{slot:"end",onClick:i[2]||(i[2]=()=>e(p)(g.recipe.id)),size:"small",type:"tertiary"},{default:s(()=>[t(v,{icon:"ioniconsTrash"in u?u.ioniconsTrash:e(Re)},null,8,["icon"])]),_:1})]),_:1})}}},Ee={};function Ke(c,f){return n(),y("span",null,[he(c.$slots,"default",{},void 0,!0)])}const J=E(Ee,[["render",Ke],["__scopeId","data-v-a302f0dd"]]),Ze={key:1},Ge={__name:"products",props:{nameDir:{type:String,default:""},dir:{type:String,default:""},lastSort:{type:String,default:""}},setup(c){const f=M(),l=c,{currentShoppingList:p}=F(f),o=I(()=>p?p.value.items:[]),r=I(()=>p.value?p.value.recipes:[]),g=I(()=>{if(o.value){let d=[...o.value];return l.lastSort==="category"?d=d.sort((_,v)=>l.dir==="asc"?_.category.localeCompare(v.category):v.category.localeCompare(_.category)):l.lastSort==="name"&&(d=d.sort((_,v)=>l.nameDir==="asc"?_.name.localeCompare(v.name):v.name.localeCompare(_.name))),d}return[]}),m=I(()=>g.value.filter(d=>!d.checked)),a=I(()=>g.value.filter(d=>d.checked)),u=I(()=>r.value.filter(d=>d.ingredients.every(_=>!_.checked))),i=I(()=>r.value.filter(d=>d.ingredients.every(_=>_.checked)));return(d,_)=>{const v=Z,b=G,L=Ne,z=J,S=U;return n(),y(C,null,[e(m).length||e(u).length?(n(),h(L,{key:0,lines:!0},{default:s(()=>[(n(!0),y(C,null,A(e(m),k=>(n(),h(v,{key:k,item:k},null,8,["item"]))),128)),(n(!0),y(C,null,A(e(u),k=>(n(),h(b,{key:k.id,recipe:k,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})):P("",!0),e(a).length||e(i).length?(n(),y("div",Ze,[t(z,null,{default:s(()=>[w("Kupione")]),_:1}),t(S,{inset:!0,class:"overflow-auto py-2"},{default:s(()=>[(n(!0),y(C,null,A(e(a),k=>(n(),h(v,{key:k,item:k},null,8,["item"]))),128)),(n(!0),y(C,null,A(e(i),k=>(n(),h(b,{key:k.id,recipe:k,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})])):P("",!0)],64)}}},Je=E(Ge,[["__scopeId","data-v-841534f2"]]),Qe={class:"ion-padding",slot:"content"},Xe={key:0},Ye={__name:"sorted-by-category",setup(c){const f=M(),{handleItemChange:l,removeItem:p}=f,{currentShoppingList:o}=F(f);I(()=>o.value?o.value.items:[]);const r=I(()=>o.value?o.value.recipes:[]),g=I(()=>{const m={};return o.value.items.forEach(a=>{m[a.category]||(m[a.category]={checked:[],unchecked:[]}),a.checked?m[a.category].checked.push(a):m[a.category].unchecked.push(a)}),m});return(m,a)=>{const u=O,i=N,d=Z,_=U,v=J,b=fe,L=ve,z=G;return n(),y(C,null,[t(L,null,{default:s(()=>[(n(!0),y(C,null,A(e(g),(S,k)=>(n(),h(b,{key:k,value:S},{default:s(()=>[t(i,{slot:"header",color:"light"},{default:s(()=>[t(u,null,{default:s(()=>[w(R(k),1)]),_:2},1024)]),_:2},1024),B("div",Qe,[t(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(n(!0),y(C,null,A(S.unchecked,$=>(n(),h(d,{key:$,item:$,onRemoveItem:()=>e(p)($),onHandleItemChange:()=>e(l)($)},null,8,["item","onRemoveItem","onHandleItemChange"]))),128))]),_:2},1024),S.checked.length?(n(),y("div",Xe,[t(v,null,{default:s(()=>[w("Kupione")]),_:1}),t(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(n(!0),y(C,null,A(S.checked,$=>(n(),h(d,{key:$,item:$,onRemoveItem:()=>e(p)($),onHandleItemChange:()=>e(l)($)},null,8,["item","onRemoveItem","onHandleItemChange"]))),128))]),_:2},1024)])):P("",!0)])]),_:2},1032,["value"]))),128))]),_:1}),t(_,{inset:!0,class:"overflow-auto"},{default:s(()=>[(n(!0),y(C,null,A(e(r),S=>(n(),h(z,{key:S.id,recipe:S,recipes:e(r)},null,8,["recipe","recipes"]))),128))]),_:1})],64)}}},et={class:"inner-content"},tt=B("h2",null,"wybierz spiżarnię",-1),nt=B("h2",null,"Twoje spiżarnie",-1),ot={key:0},st={__name:"select-pantry-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}}},setup(c){const f=K(),{pantries:l,collaboratedPantries:p}=f;return(o,r)=>{const g=O,m=N,a=U;return n(),y("div",et,[tt,t(a,{lines:"none"},{default:s(()=>[nt,(n(!0),y(C,null,A(e(l),u=>(n(),h(m,{key:u.id,onClick:i=>c.confirmModal(u)},{default:s(()=>[t(g,null,{default:s(()=>[w(R(u.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),e(p)&&e(p).length?(n(),y("h2",ot," Spiżarnie do których Cię dodano ")):P("",!0),(n(!0),y(C,null,A(e(p),u=>(n(),h(m,{key:u.id,onClick:i=>c.confirmModal(u)},{default:s(()=>[t(g,null,{default:s(()=>[w(R(u.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},at={class:"h-[90%]"},lt={key:0},ct={key:1},pt={__name:"index",setup(c){const f=H(),l=K(),{handlePantryItemsFromShoppingList:p}=l,o=M(),{updateShoppingList:r,removeAllItems:g,selectAllItems:m,deselectAllItems:a,removeSelectedItems:u}=o,{currentShoppingList:i}=F(o),d=D("products"),_=D("asc"),v=D("asc"),b=D(""),L=D(!1),z=D(),S=()=>L.value=!1,k=async x=>{const W=i.value.items.filter(T=>T.checked);i.value.items=i.value.items.filter(T=>!T.checked),await p(W,x),await r({...i.value,items:i.value.items}),L.value=!1},$=I(()=>i!=null&&i.value?i.value.name:""),Q=()=>{_.value=_.value==="asc"?"desc":"asc",b.value="category"},X=()=>{v.value=v.value==="asc"?"desc":"asc",b.value="name"},Y=x=>{d.value=x},ee=()=>{q(`/shopping-lists/${f.params.id}/add-item`)},te=()=>{L.value=!0};return(x,W)=>{const T=Ie,V=Se,ne=Ce,oe=Fe,se=be,ae=$e,le=Je,ce=Ye,ie=st,re=Le,ue=j,de=Ae,me=Be,_e=xe,pe=ke;return n(),h(pe,null,{default:s(()=>[t(ae,{style:{background:"var(--ion-color-light)"}},{default:s(()=>[t(se,null,{default:s(()=>[t(V,{slot:"start"},{default:s(()=>[t(T,{text:"",icon:"ioniconsArrowBackOutline"in x?x.ioniconsArrowBackOutline:e(ze)},null,8,["icon"])]),_:1}),t(ne,null,{default:s(()=>[w("Listy zakupowe")]),_:1}),t(V,{slot:"end"},{default:s(()=>[t(oe,{layout:e(d),dir:e(_),nameDir:e(v),lastSort:e(b),onChangeLayout:Y,onSortByCategory:Q,onSortByName:X,onOpenPantryModal:te,onRemoveAllItems:e(g),onRemoveSelectedItems:e(u),onSelectAllItems:e(m),onDeselectAllItems:e(a)},null,8,["layout","dir","nameDir","lastSort","onRemoveAllItems","onRemoveSelectedItems","onSelectAllItems","onDeselectAllItems"])]),_:1})]),_:1})]),_:1}),t(_e,null,{default:s(()=>[B("div",at,[B("h2",null,R(e($)),1),e(i).items.length||e(i).recipes.length?(n(),y("div",lt,[e(d)=="products"?(n(),h(le,{key:0,dir:e(_),nameDir:e(v),lastSort:e(b)},null,8,["dir","nameDir","lastSort"])):(n(),h(ce,{key:1}))])):(n(),y("h3",ct,"Brak produktów na liście")),t(re,{class:"auto-height",ref_key:"modal",ref:z,"is-open":e(L),onWillDismiss:S},{default:s(()=>[t(ie,{cancel:S,confirmModal:k})]),_:1},8,["is-open"]),t(me,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:s(()=>[t(de,{onClick:ee},{default:s(()=>[t(ue,{icon:"ioniconsAddCircle"in x?x.ioniconsAddCircle:e(De),size:"large"},null,8,["icon"])]),_:1})]),_:1})])]),_:1})]),_:1})}}};export{pt as default};
