import{_ as G,ac as W,L as H,aR as M,r,i as X,G as Y,o as Z,N as q,A as n,aS as J,aT as K,Z as Q,t as ee,z as a,O as te,B as g,aU as I,aV as P,x as i,y as T,aW as ae,T as ne,U as oe,S as se,V as ce,W as re,ao as le,a1 as ie,X as ue,Y as de,$ as _e,C as pe,D as fe,ad as ve}from"./B0ZLNBRr.js";import{_ as me}from"./JAm2dq49.js";import{_ as we,S as he,a as ge}from"./5sIq0veD.js";const ye=d=>(pe("data-v-356b1d61"),d=d(),fe(),d),ke={class:"w-full flex flex-col justify-center items-center h-full"},xe=ye(()=>i("span",null,"ładowanie gazetki",-1)),be={class:"h2 w-full mt-0 mb-0"},Se={class:"w-[100%] flex justify-between items-center"},Ce={__name:"index",setup(d){const{backendUrl:B}=ve(),F=W(),{idToken:j}=H(F);we.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const y=J(),D=y.params.id,R=M(he.Newspapers,()=>[]),U=r(1),l=r(1),p=r(0),k=r(""),f=r(null),_=r(null),u=r(!1),v=r(!1),x=r(!1),b=X(()=>R.value[D]),z=async(o,e)=>{try{const t={imgs:o};e&&(t.pages=e),v.value=!0,u.value=!0;const s=j.value,c=await ae.post(`${B}/html/pdfFromLinks`,t,{responseType:"arraybuffer",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});return e===void 0&&(x.value=!0),c.data}catch(t){throw u.value=!1,console.error("Error fetching content:",t),t}},S=async o=>{try{const e=await z(b.value.imgs,o),t=new Uint8Array(e);ge({data:t}).promise.then(c=>{_.value=c,p.value=_.value.numPages,m(l.value)}).catch(c=>{alert("Failed to load PDF: "+c.message)})}catch(e){alert("Failed to load PDF: "+e.message)}},A=()=>{l.value>1&&(l.value--,m(l.value))},N=()=>{l.value<p.value&&(l.value++,m(l.value))},m=async o=>{if(!(!_.value||!v.value))try{const e=await K(_.value).getPage(o),t=e.getViewport({scale:U.value}),s=document.createElement("canvas"),c=s.getContext("2d");s.width=t.width,s.height=t.height;const w={canvasContext:c,viewport:t};await e.render(w).promise,s.style.width="100%",f.value.innerHTML="",f.value.appendChild(s),u.value=!1,k.value=`Strona ${o} z ${x.value?p.value:"..."}`}catch(e){alert("Failed to render page: "+e.message)}};return Y(y,async(o,e)=>{v.value=!1}),Z(async()=>{await S(10),await S()}),(o,e)=>{const t=ne,s=oe,c=se,w=ce,V=re,L=le,h=ie,C=ue,O=me,$=de,E=Q;return ee(),q(E,null,{default:n(()=>[a(V,{style:{background:"var(--ion-color-light)"}},{default:n(()=>[a(w,null,{default:n(()=>[a(s,{slot:"start"},{default:n(()=>[a(t,{text:"",icon:"ioniconsArrowBackOutline"in o?o.ioniconsArrowBackOutline:te(_e)},null,8,["icon"])]),_:1}),a(c,null,{default:n(()=>[g("Gazetki")]),_:1})]),_:1})]),_:1}),a($,null,{default:n(()=>[I(i("div",ke,[a(L,{name:"lines-sharp"}),xe],512),[[P,u.value]]),I(i("div",null,[a(O,{class:"py-0 gap-0"},{default:n(()=>[a(h,{class:"text-center"},{default:n(()=>[i("h1",be,T(b.value.title),1)]),_:1}),a(h,{class:"canvas"},{default:n(()=>[i("div",{ref_key:"pagesContainer",ref:f,class:"w-[100%]"},null,512)]),_:1}),a(h,null,{default:n(()=>[i("div",Se,[a(C,{type:"tertiary",onClick:A},{default:n(()=>[g(" Poprzednia ")]),_:1}),i("span",null,T(k.value),1),a(C,{type:"tertiary",onClick:N},{default:n(()=>[g("Następna")]),_:1})])]),_:1})]),_:1})],512),[[P,!u.value]])]),_:1})]),_:1})}}},Fe=G(Ce,[["__scopeId","data-v-356b1d61"]]);export{Fe as default};
