import{_ as O,aP as E,r as s,i as G,G as L,o as H,N as M,A as n,aQ as W,aR as Q,a5 as Z,t as q,z as a,P as J,B as w,aS as C,aT as b,x as l,y as P,aU as K,ad as X,U as Y,a2 as ee,V as ae,W as te,ak as ne,Z as oe,T as se,$ as re,a4 as ce,af as le,C as ie,D as ue,az as _e}from"./DRa_VBAG.js";import{_ as pe,S as de,a as fe}from"./Ct1yQLQ3.js";const ve=u=>(ie("data-v-137735ac"),u=u(),ue(),u),me={class:"w-full flex flex-col justify-center items-center h-full"},he=ve(()=>l("span",null,"ładowanie gazetki",-1)),ge={class:"text-base"},we={class:"w-[100%] flex justify-between items-center"},ke={__name:"index",setup(u){const{backendUrl:S}=_e();pe.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const k=W(),B=k.params.id,T=E(de.Newspapers,()=>[]),j=s(1),r=s(1),p=s(0),y=s(""),d=s(null),_=s(null),i=s(!1),f=s(!1),x=G(()=>T.value[B]),z=async t=>{try{f.value=!0,i.value=!0;const e=localStorage.getItem("idToken");return(await K.get(`${S}/html/pdf`,{params:{url:t},responseType:"arraybuffer",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}})).data}catch(e){throw i.value=!1,console.error("Error fetching content:",e),e}},D=async()=>{try{const t=await z(x.value.url),e=new Uint8Array(t);fe({data:e}).promise.then(o=>{_.value=o,p.value=_.value.numPages,v(r.value)}).catch(o=>{alert("Failed to load PDF: "+o.message)})}catch(t){alert("Failed to load PDF: "+t.message)}},F=()=>{r.value>1&&(r.value--,v(r.value))},A=()=>{r.value<p.value&&(r.value++,v(r.value))},v=async t=>{if(!(!_.value||!f.value))try{const e=await Q(_.value).getPage(t),c=e.getViewport({scale:j.value}),o=document.createElement("canvas"),m=o.getContext("2d");o.width=c.width,o.height=c.height;const h={canvasContext:m,viewport:c};await e.render(h).promise,o.style.width="100%",d.value.innerHTML="",d.value.appendChild(o),i.value=!1,y.value=`Strona ${t} z ${p.value}`}catch(e){alert("Failed to render page: "+e.message)}};return L(k,async(t,e)=>{f.value=!1}),H(()=>{D()}),(t,e)=>{const c=X,o=Y,m=ee,h=ae,N=te,R=ne,g=oe,I=se,U=re,V=ce,$=Z;return q(),M($,null,{default:n(()=>[a(N,{style:{background:"var(--ion-color-light)"}},{default:n(()=>[a(h,null,{default:n(()=>[a(o,{slot:"start"},{default:n(()=>[a(c,{text:"",icon:"ioniconsArrowBackOutline"in t?t.ioniconsArrowBackOutline:J(le)},null,8,["icon"])]),_:1}),a(m,null,{default:n(()=>[w("Gazetki")]),_:1})]),_:1})]),_:1}),a(V,null,{default:n(()=>[C(l("div",me,[a(R,{name:"lines-sharp"}),he],512),[[b,i.value]]),C(l("div",null,[a(U,{lines:"none"},{default:n(()=>[a(g,null,{default:n(()=>[l("h1",ge,P(x.value.title),1)]),_:1}),a(g,{class:"canvas"},{default:n(()=>[l("div",{ref_key:"pagesContainer",ref:d,class:"w-[100%]"},null,512)]),_:1}),a(g,null,{default:n(()=>[l("div",we,[a(I,{type:"tertiary",onClick:F},{default:n(()=>[w(" Poprzednia ")]),_:1}),l("span",null,P(y.value),1),a(I,{type:"tertiary",onClick:A},{default:n(()=>[w("Następna")]),_:1})])]),_:1})]),_:1})],512),[[b,!i.value]])]),_:1})]),_:1})}}},Ce=O(ke,[["__scopeId","data-v-137735ac"]]);export{Ce as default};
