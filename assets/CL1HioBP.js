import{i as J,t as r,N as C,A as t,aA as K,P as o,v,x as m,Q as T,z as n,y as w,aa as X,T as E,Z as P,B as y,R,S as q,aK as Y,$ as ee,_ as De,au as $e,M as Z,at as xe,r as I,G as Me,aF as ze,a2 as Qe,ah as Te,l as O,a8 as Ae,U as Be,a7 as Ve,V as Oe,W as Re,aq as qe,a1 as Ee,af as Pe,ag as je,a0 as We,aQ as Fe}from"./flSHHRYz.js";import{_ as Ne,a as Ue,b as Ge}from"./BuPswtHq.js";import{u as He}from"./Dhici30V.js";import{r as Ke,d as Ze,a as Je,h as Xe,i as Ye}from"./CHVAF33P.js";const en={key:0},nn=["src"],tn={class:"flex"},on={class:"my-auto quantity w-5 text-center"},an={__name:"item-counter",props:["quantity","category"],emits:["increaseQuantity","decreaseQuantity"],setup(d,{emit:S}){const k=d,{shoppingItems:b}=He(),s=S,_=J(()=>{const p=b.find(f=>f.category===k.category);return p?p.icon:""}),i=()=>{s("increaseQuantity")},L=()=>{s("decreaseQuantity")};return(p,f)=>{const $=X,a=E,x=P;return r(),C(x,{class:"flex items-center"},{default:t(()=>[K(p.$slots,"label"),o(_)?(r(),v("div",en,[m("img",{src:o(_),alt:"category image",class:"w-8 h-8 mr-2"},null,8,nn)])):T("",!0),m("div",tn,[n(a,{onClick:f[0]||(f[0]=()=>L()),size:"small",class:"my-0",fill:"clear"},{default:t(()=>[n($,{icon:"ioniconsRemoveOutline"in p?p.ioniconsRemoveOutline:o(Ke)},null,8,["icon"])]),_:1}),m("span",on,w(d.quantity),1),n(a,{onClick:f[1]||(f[1]=()=>i()),size:"small",class:"my-0",fill:"clear"},{default:t(()=>[n($,{icon:"ioniconsAdd"in p?p.ioniconsAdd:o(Ze)},null,8,["icon"])]),_:1}),K(p.$slots,"actions")])]),_:3})}}},sn={class:"inner-content"},ln={"data-test":"test-name"},cn={class:"w-full flex justify-between flex-wrap"},rn={__name:"add-shopping-list-modal",props:{name:{type:String,default:()=>""}},emits:["cancelShoppingModal","confirmShoppingModal"],setup(d,{emit:S}){const k=S;return(b,s)=>{const _=E;return r(),v("div",sn,[m("h2",null,[y(" Czy dodać "),m("span",ln,w(d.name),1),y(" do listy zakupowej? ")]),m("div",cn,[n(_,{onClick:s[0]||(s[0]=i=>k("cancelShoppingModal")),color:"danger","data-test":"cancel-button"},{default:t(()=>[y("Nie")]),_:1}),n(_,{onClick:s[1]||(s[1]=i=>k("confirmShoppingModal")),color:"success","data-test":"submit-button"},{default:t(()=>[y("Tak")]),_:1})])])}}},un={class:"inner-content"},dn=m("h2",null,"wybierz listę zakupową",-1),pn=m("h2",null,"Twoje listy zakupowe",-1),mn={key:0},_n={__name:"select-shopping-list-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}},shoppingLists:{type:Array,default:()=>[]},collaboratedShoppingLists:{type:Array,default:()=>[]}},setup(d){return(S,k)=>{const b=Y,s=P,_=ee;return r(),v("div",un,[dn,n(_,{lines:"none"},{default:t(()=>[pn,(r(!0),v(R,null,q(d.shoppingLists,i=>(r(),C(s,{key:i.id,onClick:L=>d.confirmModal(i)},{default:t(()=>[n(b,null,{default:t(()=>[y(w(i.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),d.collaboratedShoppingLists.length?(r(),v("h2",mn," Listy do których Cię dodano ")):T("",!0),(r(!0),v(R,null,q(d.collaboratedShoppingLists,i=>(r(),C(s,{key:i.id,onClick:L=>d.confirmModal(i)},{default:t(()=>[n(b,null,{default:t(()=>[y(w(i.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},fn={class:"h-full overflow-auto"},gn={class:"flex flex-col flex-grow"},yn={key:0,class:"text-sm"},hn={__name:"index",setup(d){const S=$e(),{increaseQuantity:k,decreaseQuantity:b}=S,{currentPantry:s}=Z(S),_=ze(),i=xe(),{getAllShoppingLists:L,updateShoppingList:p}=i,{shoppingLists:f,collaboratedShoppingLists:$}=Z(i),a=I({name:"date",dir:"asc"}),x=J(()=>{var u;const e=((u=s==null?void 0:s.value.items)==null?void 0:u.filter(h=>h.name.toLowerCase().includes(M.value.toLowerCase())))??[];if(e.length){const h=e.filter(l=>l.expiryDate),D=e.filter(l=>!l.expiryDate);if(a.value.name==="date"){if(a.value.dir==="asc")return h.sort((l,g)=>new Date(l.expiryDate)-new Date(g.expiryDate)),[...h,...D];if(a.value.dir==="desc")return h.sort((l,g)=>new Date(g.expiryDate)-new Date(l.expiryDate)),[...h,...D]}else if(a.value.name==="name"){if(a.value.dir==="asc")return e.sort((l,g)=>l.name.localeCompare(g.name));if(a.value.dir==="desc")return e.sort((l,g)=>g.name.localeCompare(l.name))}}return e}),A=I(""),M=I(""),z=I(!1),Q=I(!1),ne=I(),te=I(),B=()=>z.value=!1,V=()=>Q.value=!1;Me(_,async(e,u)=>{B(),V()});const oe=()=>B(),ae=()=>V(),se=e=>{A.value=e,z.value=!0},ie=async e=>{Q.value=!1,await p({...e,items:[...e.items,A.value]}),e.items.push(newItem)},le=async()=>{f.value.length||await L(),z.value=!1,Q.value=!0},ce=async e=>{await b(e),e.quantity===1&&se({category:e.category,name:e.name,checked:!1})},re=()=>{O(`/pantries/${s.value.id}/add-item`)},ue=e=>{O(`/pantries/${s.value.id}/${e}`)},de=e=>{O(`/pantries/${s.value.id}/${e.name}`)},pe=e=>e?new Date(e).toLocaleDateString():"",j=e=>{if(a.value!==void 0)if(e!==a.value.name)a.value={name:e,dir:"asc"};else{let u=a.value.dir==="asc"?"desc":"asc";a.value={name:e,dir:u}}else a.value={name:e,dir:"asc"}};return(e,u)=>{const h=Ae,D=Be,l=Ne,g=Ue,me=Ve,_e=Oe,fe=Re,ge=qe,W=P,F=Y,N=X,ye=E,he=ee,U=Ee,ve=Fe,Se=an,ke=Ge,be=Pe,Ie=je,we=rn,G=We,Ce=_n,Le=Qe;return r(),C(Le,null,{default:t(()=>[n(fe,{style:{background:"var(--ion-color-light)"}},{default:t(()=>[n(_e,null,{default:t(()=>[n(D,{slot:"start"},{default:t(()=>[n(h,{text:"",icon:"ioniconsArrowBackOutline"in e?e.ioniconsArrowBackOutline:o(Je)},null,8,["icon"])]),_:1}),n(D,{slot:"end"},{default:t(()=>[n(g,{sortId:"pantries-sort",width:"250px"},{default:t(()=>[n(l,{label:"Sortuj po nazwie",onClick:u[0]||(u[0]=c=>j("name")),type:"name",dir:o(a).dir,active:o(a).name==="name"},null,8,["dir","active"]),n(l,{label:"Sortuj po dacie",onClick:u[1]||(u[1]=c=>j("date")),type:"amount",dir:o(a).dir,active:o(a).name==="date"},null,8,["dir","active"])]),_:1})]),_:1}),n(me,null,{default:t(()=>[y("Spiżarnia")]),_:1})]),_:1})]),_:1}),n(U,null,{default:t(()=>[m("div",fn,[m("h2",null,w(o(s).name),1),n(W,{class:"mb-4"},{default:t(()=>[n(ge,{"data-test":"shop-input",label:"Szukaj...","label-placement":"floating",ref:"shopInput",class:"shopInput",type:"text",modelValue:o(M),"onUpdate:modelValue":u[2]||(u[2]=c=>Te(M)?M.value=c:null)},null,8,["modelValue"])]),_:1}),o(x).length?(r(),C(ke,{key:0,class:"overflow-auto max-h-[75%]"},{default:t(()=>[(r(!0),v(R,null,q(o(x),(c,H)=>(r(),C(Se,{key:c.name,onIncreaseQuantity:()=>o(k)(c),onDecreaseQuantity:()=>ce(c),quantity:c.quantity,category:c.category},{label:t(()=>[m("div",gn,[n(F,{class:"grow my-0",onClick:()=>ue(c.name)},{default:t(()=>[y(w(c.name),1)]),_:2},1032,["onClick"]),c.expiryDate?(r(),v("span",yn,w(pe(c.expiryDate)),1)):T("",!0)])]),actions:t(()=>[n(ye,{fill:"clear",id:"open-pantry-menu-"+H,class:"ml-auto",size:"small"},{default:t(()=>[n(N,{size:"medium",icon:"ioniconsEllipsisVerticalOutline"in e?e.ioniconsEllipsisVerticalOutline:o(Xe)},null,8,["icon"])]),_:2},1032,["id"]),n(ve,{trigger:"open-pantry-menu-"+H,"trigger-action":"click",side:"bottom",alignment:"center","dismiss-on-select":!0},{default:t(()=>[n(U,{class:"ion-padding mr-8"},{default:t(()=>[n(he,null,{default:t(()=>[n(W,null,{default:t(()=>[n(F,{onClick:()=>de(c)},{default:t(()=>[y("Dodaj termin przydatności")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["trigger"])]),_:2},1032,["onIncreaseQuantity","onDecreaseQuantity","quantity","category"]))),128))]),_:1})):T("",!0)]),n(Ie,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:t(()=>[n(be,{onClick:re},{default:t(()=>[n(N,{icon:"ioniconsAddCircle"in e?e.ioniconsAddCircle:o(Ye),size:"large"},null,8,["icon"])]),_:1})]),_:1}),n(G,{class:"auto-height",ref_key:"shoppingModal",ref:ne,"is-open":o(z),onWillDismiss:oe},{default:t(()=>[n(we,{onCancelShoppingModal:B,onConfirmShoppingModal:le,name:o(A).name},null,8,["name"])]),_:1},8,["is-open"]),n(G,{class:"auto-height",ref_key:"selectShoppingListModal",ref:te,"is-open":o(Q),onWillDismiss:ae},{default:t(()=>[n(Ce,{cancel:V,"confirm-modal":ie,shoppingLists:o(f),collaboratedShoppingLists:o($)},null,8,["shoppingLists","collaboratedShoppingLists"])]),_:1},8,["is-open"])]),_:1})]),_:1})}}},In=De(hn,[["__scopeId","data-v-827b2f5c"]]);export{In as default};
