import{i as ce,t as i,N as v,A as t,aO as ae,O as a,v as k,x as n,P as $,z as e,b1 as Te,y as C,a9 as Ae,a5 as re,X as F,a1 as N,B as z,R,Q as q,al as de,ag as Ve,_ as Oe,aG as Qe,L as se,aF as Ee,r as g,G as We,aS as Pe,Z as Re,a2 as ie,l as qe,T as Fe,U as Ne,S as Ue,V as Ge,W as Je,ap as Ye,aq as Ze,a4 as He,Y as Xe,as as Ke,at as et,a7 as tt,$ as ot,b2 as nt,b3 as at,C as st,D as it,b4 as lt}from"./BWu8aB2l.js";import{_ as ct,a as rt}from"./BTCxqmR1.js";import{_ as dt}from"./BDFs4i4q.js";import{_ as le}from"./5OL8AJSF.js";import{u as ut}from"./CRuhJMTC.js";const pt={key:0},_t=["src"],mt={class:"flex"},yt={class:"my-auto quantity w-5 text-center"},ft={__name:"item-counter",props:["quantity","category"],emits:["increaseQuantity","decreaseQuantity"],setup(d,{emit:b}){const S=d,{shoppingItems:D}=ut(),m=b,u=ce(()=>{const y=D.find(w=>w.category===S.category);return y?y.icon:""}),p=()=>{m("increaseQuantity")},I=()=>{m("decreaseQuantity")};return(y,w)=>{const L=re,j=F,l=N;return i(),v(l,{class:"flex items-center"},{default:t(()=>[ae(y.$slots,"label"),a(u)?(i(),k("div",pt,[n("img",{src:a(u),alt:"category image",class:"w-8 h-8 mr-2"},null,8,_t)])):$("",!0),n("div",mt,[e(j,{onClick:w[0]||(w[0]=()=>I()),size:"small",class:"my-0",type:"tertiary"},{default:t(()=>[e(L,{icon:"ioniconsRemoveOutline"in y?y.ioniconsRemoveOutline:a(Te)},null,8,["icon"])]),_:1}),n("span",yt,C(d.quantity),1),e(j,{onClick:w[1]||(w[1]=()=>p()),size:"small",class:"my-0",type:"tertiary"},{default:t(()=>[e(L,{icon:"ioniconsAdd"in y?y.ioniconsAdd:a(Ae)},null,8,["icon"])]),_:1}),ae(y.$slots,"actions")])]),_:3})}}},ht={class:"inner-content"},gt={class:"h2 font-bold"},kt={class:"w-full flex justify-between flex-wrap"},vt={__name:"add-shopping-list-modal",props:{name:{type:String,default:()=>""}},emits:["cancelShoppingModal","confirmShoppingModal"],setup(d,{emit:b}){const S=b;return(D,m)=>{const u=F;return i(),k("div",ht,[n("h2",null,[z(" Czy dodać "),n("span",gt,C(d.name),1),z(" do listy zakupowej? ")]),n("div",kt,[e(u,{onClick:m[0]||(m[0]=p=>S("cancelShoppingModal")),color:"alert","data-test":"cancel-button"},{default:t(()=>[z(" Nie ")]),_:1}),e(u,{onClick:m[1]||(m[1]=p=>S("confirmShoppingModal")),color:"success","data-test":"submit-button"},{default:t(()=>[z(" Tak ")]),_:1})])])}}},wt={class:"inner-content"},zt=n("h2",null,"wybierz listę zakupową",-1),bt=n("h2",null,"Twoje listy zakupowe",-1),St={key:0},Dt={__name:"select-shopping-list-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}},shoppingLists:{type:Array,default:()=>[]},collaboratedShoppingLists:{type:Array,default:()=>[]}},setup(d){return(b,S)=>{const D=de,m=N,u=Ve;return i(),k("div",wt,[zt,e(u,{lines:"none"},{default:t(()=>[bt,(i(!0),k(R,null,q(d.shoppingLists,p=>(i(),v(m,{key:p.id,onClick:I=>d.confirmModal(p)},{default:t(()=>[e(D,null,{default:t(()=>[z(C(p.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),d.collaboratedShoppingLists.length?(i(),k("h2",St," Listy do których Cię dodano ")):$("",!0),(i(!0),k(R,null,q(d.collaboratedShoppingLists,p=>(i(),v(m,{key:p.id,onClick:I=>d.confirmModal(p)},{default:t(()=>[e(D,null,{default:t(()=>[z(C(p.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},_=d=>(st("data-v-3efc296c"),d=d(),it(),d),xt={class:"h-full overflow-auto"},Ct={class:"h1"},It=_(()=>n("b",null,"Czy wiesz, że...",-1)),Lt={class:"ion-padding",slot:"content"},Mt=_(()=>n("br",null,null,-1)),$t=_(()=>n("p",null,'Termin przydatności dodasz klikając przycisk "3 kropki" na danym produkcie. Wyskoczy Ci okienko z możliwością ustawienia terminu przydatności. Jeśli masz wiele produktów i każdy z nich ma inna datę to podaj tę najkrótszą',-1)),jt=_(()=>n("br",null,null,-1)),Bt=_(()=>n("p",null,' Możesz też sortować swoje zapasy. Wystarczy, że klikniesz w ikonę "3 kropek" w prawym górnym rogu. Możesz sortować produkty po nazwie oraz dacie przydatności. Jeśli produkt nie ma daty przydatności nie będzie brany pod uwagę przy sortowaniu po dacie ',-1)),Tt=_(()=>n("br",null,null,-1)),At=_(()=>n("p",null,' Wystarczy, że klikniesz w przycisk "+" na dole ekranu i przejdziesz do strony z dodawaniem artykułów do spiżarnii ',-1)),Vt=_(()=>n("br",null,null,-1)),Ot=_(()=>n("p",null,"Możesz:",-1)),Qt=_(()=>n("ul",null,[n("li",null,"szukać artykułów w danej kategorii"),n("li",null," wyszukać artykuł spośród wszystkich kategorii "),n("li",null," doodać swój produkt, jeśli nie znaleziono produktu w żadnej z kategorii. Twój produkt zostanie dodany bez kategorii ")],-1)),Et=_(()=>n("br",null,null,-1)),Wt=_(()=>n("p",{class:"h3 font-bold"}," Dodaj swój pierwszy produkt do spiżarnii ",-1)),Pt={class:"flex flex-col flex-grow"},Rt={key:0,class:"text-sm"},qt={key:0},Ft={key:1},Nt={class:"p-2"},Ut={class:"flex justify-center"},Gt=_(()=>n("span",null," Zapisz termin",-1)),Jt={__name:"index",setup(d){const b=Qe(),{increaseQuantity:S,decreaseQuantity:D,editPantry:m}=b,{currentPantry:u}=se(b),p=Pe(),I=Ee(),{getAllShoppingLists:y,updateShoppingList:w}=I,{shoppingLists:L,collaboratedShoppingLists:j}=se(I),l=g({name:"date",dir:"asc"}),B=g(!1),U=g(null),M=g(null),T=ce(()=>{var s;const o=((s=u==null?void 0:u.value.items)==null?void 0:s.filter(h=>h.name.toLowerCase().includes(A.value.toLowerCase())))??[];if(o.length){const h=o.filter(r=>r.expiryDate),x=o.filter(r=>!r.expiryDate);if(l.value.name==="date"){if(l.value.dir==="asc")return h.sort((r,f)=>new Date(r.expiryDate)-new Date(f.expiryDate)),[...h,...x];if(l.value.dir==="desc")return h.sort((r,f)=>new Date(f.expiryDate)-new Date(r.expiryDate)),[...h,...x]}else if(l.value.name==="name"){if(l.value.dir==="asc")return o.sort((r,f)=>r.name.localeCompare(f.name));if(l.value.dir==="desc")return o.sort((r,f)=>f.name.localeCompare(r.name))}}return o}),G=g(""),A=g(""),O=g(!1),V=g(!1),ue=g(),pe=g(),Q=()=>O.value=!1,E=()=>V.value=!1;We(p,async(o,s)=>{Q(),E()});const _e=()=>{B.value=!1},me=()=>Q(),ye=()=>E(),fe=async o=>{V.value=!1,await w({...o,items:[...o.items,G.value]}),o.items.push(newItem)},he=async()=>{L.value.length||await y(),O.value=!1,V.value=!0},ge=()=>{qe(`/pantries/${u.value.id}/add-item`)},ke=o=>{B.value=!0;const s=new Date(o.expiryDate),h=String(s.getDate()).padStart(2,"0"),x=String(s.getMonth()+1).padStart(2,"0"),r=s.getFullYear();U.value=o;const f=`${r}-${x}-${h}`;M.value=f},ve=o=>o?new Date(o).toLocaleDateString():"",J=o=>{if(l.value!==void 0)if(o!==l.value.name)l.value={name:o,dir:"asc"};else{let s=l.value.dir==="asc"?"desc":"asc";l.value={name:o,dir:s}}else l.value={name:o,dir:"asc"}},we=()=>{const o=u.value.items.map(s=>(s.name===U.value.name&&(s.expiryDate=new Date(M.value).getTime()),s));m({...u.value,items:o}),B.value=!1};return(o,s)=>{const h=Fe,x=Ne,r=ct,f=rt,ze=Ue,be=Ge,Se=Je,W=de,Y=N,Z=dt,De=Ye,xe=Ze,H=He,X=le,K=re,ee=F,te=le,oe=Xe,Ce=lt,Ie=ft,Le=Ke,Me=et,P=tt,$e=vt,je=Dt,Be=Re;return i(),v(Be,null,{default:t(()=>[e(Se,{style:{background:"var(--ion-color-light)"}},{default:t(()=>[e(be,null,{default:t(()=>[e(x,{slot:"start"},{default:t(()=>[e(h,{text:"",icon:"ioniconsArrowBackOutline"in o?o.ioniconsArrowBackOutline:a(ot)},null,8,["icon"])]),_:1}),a(T).length?(i(),v(x,{key:0,slot:"end"},{default:t(()=>[e(f,{sortId:"pantries-sort",width:"250px"},{default:t(()=>[e(r,{label:"Sortuj po nazwie",onClick:s[0]||(s[0]=c=>J("name")),type:"name",dir:a(l).dir,active:a(l).name==="name"},null,8,["dir","active"]),e(r,{label:"Sortuj po dacie",onClick:s[1]||(s[1]=c=>J("date")),type:"amount",dir:a(l).dir,active:a(l).name==="date"},null,8,["dir","active"])]),_:1})]),_:1})):$("",!0),e(ze,null,{default:t(()=>[z("Spiżarnia")]),_:1})]),_:1})]),_:1}),e(oe,null,{default:t(()=>[n("div",xt,[n("h2",Ct,C(a(u).name),1),a(T).length?(i(),v(xe,{key:0},{default:t(()=>[e(De,{value:"first"},{default:t(()=>[e(Y,{slot:"header",color:"light"},{default:t(()=>[e(W,null,{default:t(()=>[It]),_:1})]),_:1}),n("div",Lt,[e(Z,{subtitle:"Możesz sortować swoje zapasy oraz dodawać do nich termin przydatności?",icon:"ioniconsBulb",class:"mb-4 mt-2"},{default:t(()=>[Mt,$t,jt,Bt]),_:1})])]),_:1})]),_:1})):$("",!0),a(T).length?(i(),v(X,{key:1},{default:t(()=>[e(H,{label:"Wyszukaj produkt",type:"text",placeholder:"Szukaj...",modelValue:a(A),"onUpdate:modelValue":s[2]||(s[2]=c=>ie(A)?A.value=c:null)},null,8,["modelValue"])]),_:1})):(i(),v(Z,{key:2,title:"Czy wiesz, że...",subtitle:"Możesz dodawać produkty z naszej bazy lub swoje własne?",icon:"ioniconsBulb",class:"mt-8"},{default:t(()=>[Tt,At,Vt,Ot,Qt,Et,Wt]),_:1})),e(X,{class:"overflow-auto max-h-[75%]"},{default:t(()=>[(i(!0),k(R,null,q(a(T),(c,ne)=>(i(),v(Ie,{key:c.name,onIncreaseQuantity:()=>a(S)(c),onDecreaseQuantity:()=>a(D)(c),quantity:c.quantity,category:c.category},{label:t(()=>[n("div",Pt,[e(W,{class:"grow my-0"},{default:t(()=>[z(C(c.name),1)]),_:2},1024),c.expiryDate?(i(),k("span",Rt,C(ve(c.expiryDate)),1)):$("",!0)])]),actions:t(()=>[e(ee,{type:"tertiary",id:"open-pantry-menu-"+ne,class:"ml-auto",size:"small"},{default:t(()=>[e(K,{size:"medium",icon:"ioniconsEllipsisVerticalOutline"in o?o.ioniconsEllipsisVerticalOutline:a(nt)},null,8,["icon"])]),_:2},1032,["id"]),e(Ce,{trigger:"open-pantry-menu-"+ne,"trigger-action":"click",side:"bottom",alignment:"center","dismiss-on-select":!0},{default:t(()=>[e(oe,{class:"ion-padding mr-8"},{default:t(()=>[e(te,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(W,{onClick:()=>ke(c)},{default:t(()=>[c.expiryDate?(i(),k("span",Ft,"Edytuj termin przydatności")):(i(),k("span",qt,"Dodaj termin przydatności"))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["trigger"])]),_:2},1032,["onIncreaseQuantity","onDecreaseQuantity","quantity","category"]))),128))]),_:1})]),e(Me,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:t(()=>[e(Le,{onClick:ge},{default:t(()=>[e(K,{icon:"ioniconsAddCircle"in o?o.ioniconsAddCircle:a(at),size:"large"},null,8,["icon"])]),_:1})]),_:1}),e(P,{class:"auto-height","is-open":a(B),onDidDismiss:s[4]||(s[4]=c=>_e())},{default:t(()=>[n("div",Nt,[e(te,null,{default:t(()=>[e(H,{label:"Dodaj termin przydatności",modelValue:a(M),"onUpdate:modelValue":s[3]||(s[3]=c=>ie(M)?M.value=c:null),type:"date"},null,8,["modelValue"])]),_:1}),n("div",Ut,[e(ee,{onClick:we},{default:t(()=>[Gt]),_:1})])])]),_:1},8,["is-open"]),e(P,{class:"auto-height",ref_key:"shoppingModal",ref:ue,"is-open":a(O),onWillDismiss:me},{default:t(()=>[e($e,{onCancelShoppingModal:Q,onConfirmShoppingModal:he,name:a(G).name},null,8,["name"])]),_:1},8,["is-open"]),e(P,{class:"auto-height",ref_key:"selectShoppingListModal",ref:pe,"is-open":a(V),onWillDismiss:ye},{default:t(()=>[e(je,{cancel:E,"confirm-modal":fe,shoppingLists:a(L),collaboratedShoppingLists:a(j)},null,8,["shoppingLists","collaboratedShoppingLists"])]),_:1},8,["is-open"])]),_:1})]),_:1})}}},eo=Oe(Jt,[["__scopeId","data-v-3efc296c"]]);export{eo as default};
