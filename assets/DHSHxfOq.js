import{_ as E,ac as G,L as H,aQ as M,r as s,i as W,G as Q,o as X,N as Y,A as n,aR as Z,aS as q,Z as J,t as K,z as t,O as ee,B as g,aT as S,aU as C,x as l,y as b,aV as te,T as ae,U as ne,S as oe,V as se,W as re,ao as ce,a1 as le,X as ie,ag as ue,Y as _e,$ as pe,C as de,D as fe,ad as ve}from"./CGaVrOoi.js";import{_ as me,S as he,a as we}from"./ucUINqe9.js";const ge=u=>(de("data-v-1407495f"),u=u(),fe(),u),ke={class:"w-full flex flex-col justify-center items-center h-full"},ye=ge(()=>l("span",null,"ładowanie gazetki",-1)),xe={class:"text-base"},Ie={class:"w-[100%] flex justify-between items-center"},Se={__name:"index",setup(u){const{backendUrl:B}=ve(),P=G(),{idToken:T}=H(P);me.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const k=Z(),j=k.params.id,D=M(he.Newspapers,()=>[]),F=s(1),r=s(1),p=s(0),y=s(""),d=s(null),_=s(null),i=s(!1),f=s(!1),x=W(()=>D.value[j]),R=async a=>{try{f.value=!0,i.value=!0;const e=T.value;return(await te.get(`${B}/html/pdf`,{params:{url:a},responseType:"arraybuffer",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}})).data}catch(e){throw i.value=!1,console.error("Error fetching content:",e),e}},U=async()=>{try{const a=await R(x.value.url),e=new Uint8Array(a);we({data:e}).promise.then(o=>{_.value=o,p.value=_.value.numPages,v(r.value)}).catch(o=>{alert("Failed to load PDF: "+o.message)})}catch(a){alert("Failed to load PDF: "+a.message)}},z=()=>{r.value>1&&(r.value--,v(r.value))},A=()=>{r.value<p.value&&(r.value++,v(r.value))},v=async a=>{if(!(!_.value||!f.value))try{const e=await q(_.value).getPage(a),c=e.getViewport({scale:F.value}),o=document.createElement("canvas"),m=o.getContext("2d");o.width=c.width,o.height=c.height;const h={canvasContext:m,viewport:c};await e.render(h).promise,o.style.width="100%",d.value.innerHTML="",d.value.appendChild(o),i.value=!1,y.value=`Strona ${a} z ${p.value}`}catch(e){alert("Failed to render page: "+e.message)}};return Q(k,async(a,e)=>{f.value=!1}),X(()=>{U()}),(a,e)=>{const c=ae,o=ne,m=oe,h=se,N=re,V=ce,w=le,I=ie,O=ue,$=_e,L=J;return K(),Y(L,null,{default:n(()=>[t(N,{style:{background:"var(--ion-color-light)"}},{default:n(()=>[t(h,null,{default:n(()=>[t(o,{slot:"start"},{default:n(()=>[t(c,{text:"",icon:"ioniconsArrowBackOutline"in a?a.ioniconsArrowBackOutline:ee(pe)},null,8,["icon"])]),_:1}),t(m,null,{default:n(()=>[g("Gazetki")]),_:1})]),_:1})]),_:1}),t($,null,{default:n(()=>[S(l("div",ke,[t(V,{name:"lines-sharp"}),ye],512),[[C,i.value]]),S(l("div",null,[t(O,{lines:"none"},{default:n(()=>[t(w,null,{default:n(()=>[l("h1",xe,b(x.value.title),1)]),_:1}),t(w,{class:"canvas"},{default:n(()=>[l("div",{ref_key:"pagesContainer",ref:d,class:"w-[100%]"},null,512)]),_:1}),t(w,null,{default:n(()=>[l("div",Ie,[t(I,{type:"tertiary",onClick:z},{default:n(()=>[g(" Poprzednia ")]),_:1}),l("span",null,b(y.value),1),t(I,{type:"tertiary",onClick:A},{default:n(()=>[g("Następna")]),_:1})])]),_:1})]),_:1})],512),[[C,!i.value]])]),_:1})]),_:1})}}},Pe=E(Se,[["__scopeId","data-v-1407495f"]]);export{Pe as default};
