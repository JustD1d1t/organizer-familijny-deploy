import{_ as G,ac as H,L as M,aQ as W,r as c,i as Q,G as X,o as Y,N as Z,A as n,aR as q,aS as J,Z as K,t as ee,z as t,O as ae,B as g,aT as C,aU as P,x as i,y as T,aV as te,T as ne,U as oe,S as se,V as re,W as ce,ao as le,a1 as ie,X as ue,ag as de,Y as _e,$ as pe,C as fe,D as ve,ad as me}from"./Dllh6qvR.js";import{_ as we,S as he,a as ge}from"./C-t_Yqwl.js";const ke=d=>(fe("data-v-334a6870"),d=d(),ve(),d),ye={class:"w-full flex flex-col justify-center items-center h-full"},xe=ke(()=>i("span",null,"ładowanie gazetki",-1)),Se={class:"text-base"},Ie={class:"w-[100%] flex justify-between items-center"},be={__name:"index",setup(d){const{backendUrl:B}=me(),F=H(),{idToken:j}=M(F);we.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const k=q(),D=k.params.id,R=W(he.Newspapers,()=>[]),U=c(1),l=c(1),p=c(0),y=c(""),f=c(null),_=c(null),u=c(!1),v=c(!1),x=c(!1),S=Q(()=>R.value[D]),z=async(o,e)=>{try{const a={imgs:o};e&&(a.pages=e),v.value=!0,u.value=!0;const s=j.value,r=await te.post(`${B}/html/pdfFromLinks`,a,{responseType:"arraybuffer",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});return e===void 0&&(x.value=!0),r.data}catch(a){throw u.value=!1,console.error("Error fetching content:",a),a}},I=async o=>{try{const e=await z(S.value.imgs,o),a=new Uint8Array(e);ge({data:a}).promise.then(r=>{_.value=r,p.value=_.value.numPages,m(l.value)}).catch(r=>{alert("Failed to load PDF: "+r.message)})}catch(e){alert("Failed to load PDF: "+e.message)}},A=()=>{l.value>1&&(l.value--,m(l.value))},N=()=>{l.value<p.value&&(l.value++,m(l.value))},m=async o=>{if(!(!_.value||!v.value))try{const e=await J(_.value).getPage(o),a=e.getViewport({scale:U.value}),s=document.createElement("canvas"),r=s.getContext("2d");s.width=a.width,s.height=a.height;const w={canvasContext:r,viewport:a};await e.render(w).promise,s.style.width="100%",f.value.innerHTML="",f.value.appendChild(s),u.value=!1,y.value=`Strona ${o} z ${x.value?p.value:"ładowanie..."}`}catch(e){alert("Failed to render page: "+e.message)}};return X(k,async(o,e)=>{v.value=!1}),Y(async()=>{await I(10),await I()}),(o,e)=>{const a=ne,s=oe,r=se,w=re,V=ce,L=le,h=ie,b=ue,O=de,$=_e,E=K;return ee(),Z(E,null,{default:n(()=>[t(V,{style:{background:"var(--ion-color-light)"}},{default:n(()=>[t(w,null,{default:n(()=>[t(s,{slot:"start"},{default:n(()=>[t(a,{text:"",icon:"ioniconsArrowBackOutline"in o?o.ioniconsArrowBackOutline:ae(pe)},null,8,["icon"])]),_:1}),t(r,null,{default:n(()=>[g("Gazetki")]),_:1})]),_:1})]),_:1}),t($,null,{default:n(()=>[C(i("div",ye,[t(L,{name:"lines-sharp"}),xe],512),[[P,u.value]]),C(i("div",null,[t(O,{lines:"none"},{default:n(()=>[t(h,null,{default:n(()=>[i("h1",Se,T(S.value.title),1)]),_:1}),t(h,{class:"canvas"},{default:n(()=>[i("div",{ref_key:"pagesContainer",ref:f,class:"w-[100%]"},null,512)]),_:1}),t(h,null,{default:n(()=>[i("div",Ie,[t(b,{type:"tertiary",onClick:A},{default:n(()=>[g(" Poprzednia ")]),_:1}),i("span",null,T(y.value),1),t(b,{type:"tertiary",onClick:N},{default:n(()=>[g("Następna")]),_:1})])]),_:1})]),_:1})],512),[[P,!u.value]])]),_:1})]),_:1})}}},Be=G(be,[["__scopeId","data-v-334a6870"]]);export{Be as default};
