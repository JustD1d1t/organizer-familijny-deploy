import{_ as G,N as L,M,aP as H,r as s,i as Q,G as W,o as X,O as q,A as n,aQ as J,aR as K,a6 as Y,t as Z,z as t,Q as ee,B as g,aS as C,aT as S,x as l,y as b,aU as te,af as ae,V as ne,a3 as oe,W as se,X as re,ak as ce,$ as le,U as ie,a0 as ue,a5 as _e,ah as pe,C as de,D as fe,aA as ve}from"./BeL7Np4Z.js";import{_ as me,S as he,a as we}from"./DcRxOlys.js";const ge=u=>(de("data-v-1407495f"),u=u(),fe(),u),ke={class:"w-full flex flex-col justify-center items-center h-full"},ye=ge(()=>l("span",null,"ładowanie gazetki",-1)),xe={class:"text-base"},Ie={class:"w-[100%] flex justify-between items-center"},Ce={__name:"index",setup(u){const{backendUrl:P}=ve(),B=L(),{idToken:T}=M(B);me.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const k=J(),j=k.params.id,A=H(he.Newspapers,()=>[]),D=s(1),r=s(1),p=s(0),y=s(""),d=s(null),_=s(null),i=s(!1),f=s(!1),x=Q(()=>A.value[j]),F=async a=>{try{f.value=!0,i.value=!0;const e=T.value;return(await te.get(`${P}/html/pdf`,{params:{url:a},responseType:"arraybuffer",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}})).data}catch(e){throw i.value=!1,console.error("Error fetching content:",e),e}},R=async()=>{try{const a=await F(x.value.url),e=new Uint8Array(a);we({data:e}).promise.then(o=>{_.value=o,p.value=_.value.numPages,v(r.value)}).catch(o=>{alert("Failed to load PDF: "+o.message)})}catch(a){alert("Failed to load PDF: "+a.message)}},U=()=>{r.value>1&&(r.value--,v(r.value))},z=()=>{r.value<p.value&&(r.value++,v(r.value))},v=async a=>{if(!(!_.value||!f.value))try{const e=await K(_.value).getPage(a),c=e.getViewport({scale:D.value}),o=document.createElement("canvas"),m=o.getContext("2d");o.width=c.width,o.height=c.height;const h={canvasContext:m,viewport:c};await e.render(h).promise,o.style.width="100%",d.value.innerHTML="",d.value.appendChild(o),i.value=!1,y.value=`Strona ${a} z ${p.value}`}catch(e){alert("Failed to render page: "+e.message)}};return W(k,async(a,e)=>{f.value=!1}),X(()=>{R()}),(a,e)=>{const c=ae,o=ne,m=oe,h=se,N=re,O=ce,w=le,I=ie,V=ue,$=_e,E=Y;return Z(),q(E,null,{default:n(()=>[t(N,{style:{background:"var(--ion-color-light)"}},{default:n(()=>[t(h,null,{default:n(()=>[t(o,{slot:"start"},{default:n(()=>[t(c,{text:"",icon:"ioniconsArrowBackOutline"in a?a.ioniconsArrowBackOutline:ee(pe)},null,8,["icon"])]),_:1}),t(m,null,{default:n(()=>[g("Gazetki")]),_:1})]),_:1})]),_:1}),t($,null,{default:n(()=>[C(l("div",ke,[t(O,{name:"lines-sharp"}),ye],512),[[S,i.value]]),C(l("div",null,[t(V,{lines:"none"},{default:n(()=>[t(w,null,{default:n(()=>[l("h1",xe,b(x.value.title),1)]),_:1}),t(w,{class:"canvas"},{default:n(()=>[l("div",{ref_key:"pagesContainer",ref:d,class:"w-[100%]"},null,512)]),_:1}),t(w,null,{default:n(()=>[l("div",Ie,[t(I,{type:"tertiary",onClick:U},{default:n(()=>[g(" Poprzednia ")]),_:1}),l("span",null,b(y.value),1),t(I,{type:"tertiary",onClick:z},{default:n(()=>[g("Następna")]),_:1})])]),_:1})]),_:1})],512),[[S,!i.value]])]),_:1})]),_:1})}}},Be=G(Ce,[["__scopeId","data-v-1407495f"]]);export{Be as default};
