import{_ as R,aO as U,L as b,ac as G,aQ as H,r as M,i as Q,o as W,N as I,A as o,aR as Z,aV as x,Z as F,t as m,z as n,O as B,B as f,aT as T,aU as A,x as h,v as P,Q as X,R as Y,ad as J,T as K,U as ee,S as te,V as oe,W as ne,ao as ae,ag as se,Y as re,$ as ce,y as le,C as ie,D as pe,l as ue,al as _e,X as de,a1 as me}from"./9W-cnvgg.js";import{_ as fe,S as he}from"./BvO9hB1Q.js";const we=c=>(ie("data-v-2054f655"),c=c(),pe(),c),ve={class:"w-full flex flex-col justify-center items-center h-full"},ke=we(()=>h("span",null,"Å‚adowanie gazetek",-1)),Se={__name:"index",setup(c){const{backendUrl:w}=J(),C=U(),{shops:N}=b(C),$=G(),{idToken:v}=b($);fe.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs";const k=Z().params.shop,i=H(he.Newspapers,()=>[]),s=M(!1),j=Q(()=>N.value[k]),z=async()=>{try{const t=v.value;return s.value=!0,(await x.get(`${w}/html`,{params:{url:j.value.url},headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).data.data}catch(t){s.value=!1,console.error("Error fetching shops:",t)}},L=async()=>{i.value=[];const t=await z(),a=document.createElement("html");a.innerHTML=t;const p=a.querySelectorAll(".newspapper-footer p"),u=a.querySelectorAll(".newspapper-footer button"),_=Array.from(u).map(e=>e.getAttribute("rel").replace("#","")).map(e=>a.querySelector(`#${e}`)).map(e=>e.querySelector("iframe")),d=v.value,l=[];for(const e of _)if(e){const r=await x.get(`${w}/html/imgs`,{params:{url:e.dataset.src},headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});l.push(r.data.imgs)}a.querySelectorAll(".newspapper-nav-item.newspapper-nav-download"),p.forEach((e,r)=>{i.value.push({title:e.textContent,imgs:l[r]})}),s.value=!1},O=t=>{ue(`/newspaper/${k}/${t}`)};return W(()=>{L()}),(t,a)=>{const p=K,u=ee,S=te,g=oe,_=ne,d=ae,l=_e,e=de,r=me,q=se,D=re,E=F;return m(),I(E,null,{default:o(()=>[n(_,{style:{background:"var(--ion-color-light)"}},{default:o(()=>[n(g,null,{default:o(()=>[n(u,{slot:"start"},{default:o(()=>[n(p,{text:"",icon:"ioniconsArrowBackOutline"in t?t.ioniconsArrowBackOutline:B(ce)},null,8,["icon"])]),_:1}),n(S,null,{default:o(()=>[f("Gazetki")]),_:1})]),_:1})]),_:1}),n(D,null,{default:o(()=>[T(h("div",ve,[n(d,{name:"lines-sharp"}),ke],512),[[A,s.value]]),T(h("div",null,[n(q,null,{default:o(()=>[(m(!0),P(Y,null,X(B(i),(y,V)=>(m(),I(r,{key:y.title},{default:o(()=>[n(l,null,{default:o(()=>[f(le(y.title),1)]),_:2},1024),n(e,{type:"tertiary",onClick:be=>O(V)},{default:o(()=>[f(" Zobacz ")]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})],512),[[A,!s.value]])]),_:1})]),_:1})}}},Be=R(Se,[["__scopeId","data-v-2054f655"]]);export{Be as default};
