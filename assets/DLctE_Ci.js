import{i as se,t as i,N as x,A as t,aO as te,O as o,v as y,x as d,P as V,z as e,b1 as Me,y as I,a9 as ze,a5 as ie,X as W,a1 as q,B as S,R as P,Q as R,al as le,ag as Be,_ as Te,aE as Ve,L as ne,aD as Ae,r as h,G as Ee,aS as Oe,Z as Qe,a2 as oe,l as je,T as Pe,U as Re,S as We,V as qe,W as Fe,a4 as Ne,Y as Ue,aq as Ye,ar as Ze,a7 as Ge,$ as He,b2 as Xe,b3 as Je,C as Ke,D as et,b4 as tt}from"./B0ZLNBRr.js";import{_ as nt,a as ot}from"./DlkC2NoW.js";import{_ as ae}from"./JAm2dq49.js";import{u as at}from"./ZxR0iDOO.js";const st={key:0},it=["src"],lt={class:"flex"},ct={class:"my-auto quantity w-5 text-center"},rt={__name:"item-counter",props:["quantity","category"],emits:["increaseQuantity","decreaseQuantity"],setup(r,{emit:k}){const D=r,{shoppingItems:b}=at(),m=k,u=se(()=>{const _=b.find(v=>v.category===D.category);return _?_.icon:""}),p=()=>{m("increaseQuantity")},L=()=>{m("decreaseQuantity")};return(_,v)=>{const C=ie,M=W,s=q;return i(),x(s,{class:"flex items-center"},{default:t(()=>[te(_.$slots,"label"),o(u)?(i(),y("div",st,[d("img",{src:o(u),alt:"category image",class:"w-8 h-8 mr-2"},null,8,it)])):V("",!0),d("div",lt,[e(M,{onClick:v[0]||(v[0]=()=>L()),size:"small",class:"my-0",type:"tertiary"},{default:t(()=>[e(C,{icon:"ioniconsRemoveOutline"in _?_.ioniconsRemoveOutline:o(Me)},null,8,["icon"])]),_:1}),d("span",ct,I(r.quantity),1),e(M,{onClick:v[1]||(v[1]=()=>p()),size:"small",class:"my-0",type:"tertiary"},{default:t(()=>[e(C,{icon:"ioniconsAdd"in _?_.ioniconsAdd:o(ze)},null,8,["icon"])]),_:1}),te(_.$slots,"actions")])]),_:3})}}},ut={class:"inner-content"},dt={class:"h2 font-bold"},pt={class:"w-full flex justify-between flex-wrap"},mt={__name:"add-shopping-list-modal",props:{name:{type:String,default:()=>""}},emits:["cancelShoppingModal","confirmShoppingModal"],setup(r,{emit:k}){const D=k;return(b,m)=>{const u=W;return i(),y("div",ut,[d("h2",null,[S(" Czy dodać "),d("span",dt,I(r.name),1),S(" do listy zakupowej? ")]),d("div",pt,[e(u,{onClick:m[0]||(m[0]=p=>D("cancelShoppingModal")),color:"alert","data-test":"cancel-button"},{default:t(()=>[S(" Nie ")]),_:1}),e(u,{onClick:m[1]||(m[1]=p=>D("confirmShoppingModal")),color:"success","data-test":"submit-button"},{default:t(()=>[S(" Tak ")]),_:1})])])}}},_t={class:"inner-content"},ft=d("h2",null,"wybierz listę zakupową",-1),yt=d("h2",null,"Twoje listy zakupowe",-1),gt={key:0},ht={__name:"select-shopping-list-modal",props:{cancel:{type:Function,default:()=>{}},confirmModal:{type:Function,default:()=>{}},shoppingLists:{type:Array,default:()=>[]},collaboratedShoppingLists:{type:Array,default:()=>[]}},setup(r){return(k,D)=>{const b=le,m=q,u=Be;return i(),y("div",_t,[ft,e(u,{lines:"none"},{default:t(()=>[yt,(i(!0),y(P,null,R(r.shoppingLists,p=>(i(),x(m,{key:p.id,onClick:L=>r.confirmModal(p)},{default:t(()=>[e(b,null,{default:t(()=>[S(I(p.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),r.collaboratedShoppingLists.length?(i(),y("h2",gt," Listy do których Cię dodano ")):V("",!0),(i(!0),y(P,null,R(r.collaboratedShoppingLists,p=>(i(),x(m,{key:p.id,onClick:L=>r.confirmModal(p)},{default:t(()=>[e(b,null,{default:t(()=>[S(I(p.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])}}},vt=r=>(Ke("data-v-5660c4c9"),r=r(),et(),r),St={class:"h-full overflow-auto"},kt={class:"h1"},Dt={key:1},bt={class:"flex flex-col flex-grow"},wt={key:0,class:"text-sm"},xt={key:0},It={key:1},Lt={class:"p-2"},Ct={class:"flex justify-center"},$t=vt(()=>d("span",null," Zapisz termin",-1)),Mt={__name:"index",setup(r){const k=Ve(),{increaseQuantity:D,decreaseQuantity:b,editPantry:m}=k,{currentPantry:u}=ne(k),p=Oe(),L=Ae(),{getAllShoppingLists:_,updateShoppingList:v}=L,{shoppingLists:C,collaboratedShoppingLists:M}=ne(L),s=h({name:"date",dir:"asc"}),z=h(!1),F=h(null),$=h(null),A=se(()=>{var a;const n=((a=u==null?void 0:u.value.items)==null?void 0:a.filter(g=>g.name.toLowerCase().includes(B.value.toLowerCase())))??[];if(n.length){const g=n.filter(c=>c.expiryDate),w=n.filter(c=>!c.expiryDate);if(s.value.name==="date"){if(s.value.dir==="asc")return g.sort((c,f)=>new Date(c.expiryDate)-new Date(f.expiryDate)),[...g,...w];if(s.value.dir==="desc")return g.sort((c,f)=>new Date(f.expiryDate)-new Date(c.expiryDate)),[...g,...w]}else if(s.value.name==="name"){if(s.value.dir==="asc")return n.sort((c,f)=>c.name.localeCompare(f.name));if(s.value.dir==="desc")return n.sort((c,f)=>f.name.localeCompare(c.name))}}return n}),N=h(""),B=h(""),E=h(!1),T=h(!1),ce=h(),re=h(),O=()=>E.value=!1,Q=()=>T.value=!1;Ee(p,async(n,a)=>{O(),Q()});const ue=()=>{z.value=!1},de=()=>O(),pe=()=>Q(),me=async n=>{T.value=!1,await v({...n,items:[...n.items,N.value]}),n.items.push(newItem)},_e=async()=>{C.value.length||await _(),E.value=!1,T.value=!0},fe=()=>{je(`/pantries/${u.value.id}/add-item`)},ye=n=>{z.value=!0;const a=new Date(n.expiryDate),g=String(a.getDate()).padStart(2,"0"),w=String(a.getMonth()+1).padStart(2,"0"),c=a.getFullYear();F.value=n;const f=`${c}-${w}-${g}`;$.value=f},ge=n=>n?new Date(n).toLocaleDateString():"",U=n=>{if(s.value!==void 0)if(n!==s.value.name)s.value={name:n,dir:"asc"};else{let a=s.value.dir==="asc"?"desc":"asc";s.value={name:n,dir:a}}else s.value={name:n,dir:"asc"}},he=()=>{const n=u.value.items.map(a=>(a.name===F.value.name&&(a.expiryDate=new Date($.value).getTime()),a));m({...u.value,items:n}),z.value=!1};return(n,a)=>{const g=Pe,w=Re,c=nt,f=ot,ve=We,Se=qe,ke=Fe,Y=Ne,Z=ae,G=le,H=ie,X=W,De=q,J=ae,K=Ue,be=tt,we=rt,xe=Ye,Ie=Ze,j=Ge,Le=mt,Ce=ht,$e=Qe;return i(),x($e,null,{default:t(()=>[e(ke,{style:{background:"var(--ion-color-light)"}},{default:t(()=>[e(Se,null,{default:t(()=>[e(w,{slot:"start"},{default:t(()=>[e(g,{text:"",icon:"ioniconsArrowBackOutline"in n?n.ioniconsArrowBackOutline:o(He)},null,8,["icon"])]),_:1}),o(A).length?(i(),x(w,{key:0,slot:"end"},{default:t(()=>[e(f,{sortId:"pantries-sort",width:"250px"},{default:t(()=>[e(c,{label:"Sortuj po nazwie",onClick:a[0]||(a[0]=l=>U("name")),type:"name",dir:o(s).dir,active:o(s).name==="name"},null,8,["dir","active"]),e(c,{label:"Sortuj po dacie",onClick:a[1]||(a[1]=l=>U("date")),type:"amount",dir:o(s).dir,active:o(s).name==="date"},null,8,["dir","active"])]),_:1})]),_:1})):V("",!0),e(ve,null,{default:t(()=>[S("Spiżarnia")]),_:1})]),_:1})]),_:1}),e(K,null,{default:t(()=>[d("div",St,[d("h2",kt,I(o(u).name),1),o(A).length?(i(),x(Z,{key:0},{default:t(()=>[e(Y,{label:"Wyszukaj produkt",type:"text",placeholder:"Szukaj...",modelValue:o(B),"onUpdate:modelValue":a[2]||(a[2]=l=>oe(B)?B.value=l:null)},null,8,["modelValue"])]),_:1})):(i(),y("h3",Dt,"Brak produktów w spiżarni")),e(Z,{class:"overflow-auto max-h-[75%]"},{default:t(()=>[(i(!0),y(P,null,R(o(A),(l,ee)=>(i(),x(we,{key:l.name,onIncreaseQuantity:()=>o(D)(l),onDecreaseQuantity:()=>o(b)(l),quantity:l.quantity,category:l.category},{label:t(()=>[d("div",bt,[e(G,{class:"grow my-0"},{default:t(()=>[S(I(l.name),1)]),_:2},1024),l.expiryDate?(i(),y("span",wt,I(ge(l.expiryDate)),1)):V("",!0)])]),actions:t(()=>[e(X,{type:"tertiary",id:"open-pantry-menu-"+ee,class:"ml-auto",size:"small"},{default:t(()=>[e(H,{size:"medium",icon:"ioniconsEllipsisVerticalOutline"in n?n.ioniconsEllipsisVerticalOutline:o(Xe)},null,8,["icon"])]),_:2},1032,["id"]),e(be,{trigger:"open-pantry-menu-"+ee,"trigger-action":"click",side:"bottom",alignment:"center","dismiss-on-select":!0},{default:t(()=>[e(K,{class:"ion-padding mr-8"},{default:t(()=>[e(J,null,{default:t(()=>[e(De,null,{default:t(()=>[e(G,{onClick:()=>ye(l)},{default:t(()=>[l.expiryDate?(i(),y("span",It,"Edytuj termin przydatności")):(i(),y("span",xt,"Dodaj termin przydatności"))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["trigger"])]),_:2},1032,["onIncreaseQuantity","onDecreaseQuantity","quantity","category"]))),128))]),_:1})]),e(Ie,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:t(()=>[e(xe,{onClick:fe},{default:t(()=>[e(H,{icon:"ioniconsAddCircle"in n?n.ioniconsAddCircle:o(Je),size:"large"},null,8,["icon"])]),_:1})]),_:1}),e(j,{class:"auto-height","is-open":o(z),onDidDismiss:a[4]||(a[4]=l=>ue())},{default:t(()=>[d("div",Lt,[e(J,null,{default:t(()=>[e(Y,{label:"Dodaj termin przydatności",modelValue:o($),"onUpdate:modelValue":a[3]||(a[3]=l=>oe($)?$.value=l:null),type:"date"},null,8,["modelValue"])]),_:1}),d("div",Ct,[e(X,{onClick:he},{default:t(()=>[$t]),_:1})])])]),_:1},8,["is-open"]),e(j,{class:"auto-height",ref_key:"shoppingModal",ref:ce,"is-open":o(E),onWillDismiss:de},{default:t(()=>[e(Le,{onCancelShoppingModal:O,onConfirmShoppingModal:_e,name:o(N).name},null,8,["name"])]),_:1},8,["is-open"]),e(j,{class:"auto-height",ref_key:"selectShoppingListModal",ref:re,"is-open":o(T),onWillDismiss:pe},{default:t(()=>[e(Ce,{cancel:Q,"confirm-modal":me,shoppingLists:o(C),collaboratedShoppingLists:o(M)},null,8,["shoppingLists","collaboratedShoppingLists"])]),_:1},8,["is-open"])]),_:1})]),_:1})}}},At=Te(Mt,[["__scopeId","data-v-5660c4c9"]]);export{At as default};
