import{_ as be,M as ge,L as Q,ac as ke,r as d,o as we,N as m,A as a,af as Ve,Z as Ie,t as s,z as t,O as o,B as r,P as w,v,R as b,Q as g,x as X,X as Ce,U as xe,V as Ne,W as Ue,a4 as De,a6 as Se,a1 as Me,ag as Pe,a5 as Be,a7 as ze,S as Ee,ah as $e,Y as Te,y as W,a9 as Fe,a3 as Ae,ai as Oe,aa as Re,aj as We}from"./CSz8cOni.js";import{_ as je}from"./4MMZrP91.js";import{_ as Le}from"./wr8qbplU.js";import{_ as Ke}from"./CoaZJDH_.js";import{u as Ze}from"./B4tFuksg.js";const Ye={key:0,class:"inner-content"},Ge={class:"modal-content"},He={__name:"index-full-read",setup(Qe){const{photos:V,photoFromCamera:Xe,selectPhotoFromData:qe}=Ze(),j=ge(),{removeExpenseFromStore:q,editExpense:J,getExpensePhoto:h}=j,{currentExpense:n}=Q(j),{billCategories:N}=Ae(),{openAlert:ee}=Oe(),te=ke(),{uid:_}=Q(te),L=Ve();d("");const U=d(!1),le=d(null),ae=d(null);d(!1);const f=d(null),i=d({name:"",price:"",category:""}),D=d(n.value.shop),S=d(n.value.name),M=d(n.value.value),I=d(n.value.timestamp),K=d(n.value.familyMembers),C=d([...n.value.items]),oe=()=>{let u;n.value.timestamp.seconds?u=new Date(n.value.timestamp.seconds*1e3):u=new Date(n.value.timestamp);const l=u.getFullYear(),k=String(u.getMonth()+1).padStart(2,"0"),y=String(u.getDate()).padStart(2,"0");I.value=`${l}-${k}-${y}`},ne=()=>{U.value=!1},Z=d(!1),Y=d(!1),ue=async()=>{const u={name:S.value,value:Number(M.value),timestamp:new Date(I.value).getTime(),shop:D.value,familyMembers:K.value,userId:n.value.userId,id:n.value.id,category:n.value.category,items:C.value};await J(u,le.value,ae.value),L.back()},se=async()=>{await q(n.value.id),L.back()},de=async()=>{const u=await h(n.value.id);u&&V.value.push({webviewPath:u,document:{title:"New Photo",description:"Photo taken with the app",timestamp:new Date}})},re=async()=>{U.value=!0};we(async()=>{await de(),oe()});const ie=u=>{K.value=u},x=u=>Z.value=u,P=u=>Y.value=u,me=u=>{f.value=u,x(!0)},pe=()=>{C.value.push({name:i.value.name,price:parseFloat(i.value.price),category:i.value.category}),P(!1),i.value={name:"",price:"",category:""}};return(u,l)=>{const k=Ce,y=xe,B=Ne,z=Ue,p=De,E=Re,$=Se,T=Me,ce=je,ve=Pe,_e=Le,F=Ke,fe=Be,G=We,A=ze,H=Ee,O=$e,R=Te,ye=Ie;return s(),m(ye,null,{default:a(()=>[t(z,{style:{background:"var(--ion-color-light)"}},{default:a(()=>[t(B,null,{default:a(()=>[o(n)&&o(n).userId===o(_)?(s(),m(y,{key:0,slot:"start"},{default:a(()=>[t(k,{type:"tertiary",strong:!0,color:"danger",onClick:l[0]||(l[0]=()=>o(ee)("Usuwanie wydatku","Czy na pewno chcesz usunąć wydatek?","alert-button-confirm",se))},{default:a(()=>[r("Usuń")]),_:1})]),_:1})):w("",!0),o(n)&&o(n).userId===o(_)?(s(),m(y,{key:1,slot:"end"},{default:a(()=>[t(k,{type:"tertiary",strong:!0,color:"success",onClick:l[1]||(l[1]=e=>ue())},{default:a(()=>[r("Zapisz")]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1}),t(R,{fullscreen:!0},{default:a(()=>[o(n)?(s(),v("div",Ye,[t(ve,{lines:"none"},{default:a(()=>[t(p,{label:"Nazwa sklepu",type:"text",modelValue:D.value,"onUpdate:modelValue":l[2]||(l[2]=e=>D.value=e),disabled:o(n).userId!==o(_)},null,8,["modelValue","disabled"]),t(p,{label:"Nazwa wydatku",type:"text",modelValue:S.value,"onUpdate:modelValue":l[3]||(l[3]=e=>S.value=e),disabled:o(n).userId!==o(_)},null,8,["modelValue","disabled"]),t(p,{label:"Całkowita kwota",type:"number",modelValue:M.value,"onUpdate:modelValue":l[4]||(l[4]=e=>M.value=e),disabled:o(n).userId!==o(_)},null,8,["modelValue","disabled"]),t(p,{label:"Data",type:"date",modelValue:I.value,"onUpdate:modelValue":l[5]||(l[5]=e=>I.value=e),disabled:o(n).userId!==o(_)},null,8,["modelValue","disabled"]),t(T,null,{default:a(()=>[t($,{label:"Kategoria","label-placement":"stacked",modelValue:o(n).category,"onUpdate:modelValue":l[6]||(l[6]=e=>o(n).category=e)},{default:a(()=>[(s(!0),v(b,null,g(o(N),(e,c)=>(s(),m(E,{key:c,value:e},{default:a(()=>[r(W(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(n).userId===o(_)?(s(),m(ce,{key:0,members:o(n).familyMembers,onToggleMember:ie},null,8,["members"])):w("",!0)]),_:1}),t(F,null,{default:a(()=>[(s(!0),v(b,null,g(C.value,(e,c)=>(s(),m(_e,{key:c,name:e.name,price:e.price,category:e.category,onButtonClick:()=>me(e),onRemoveClick:()=>C.value.splice(c,1)},null,8,["name","price","category","onButtonClick","onRemoveClick"]))),128))]),_:1}),t(k,{type:"tertiary",class:"w-full",onClick:l[7]||(l[7]=e=>P(!0))},{default:a(()=>[t(fe,{slot:"icon-only",icon:"ioniconsAdd"in u?u.ioniconsAdd:o(Fe)},null,8,["icon"]),r(" Dodaj produkt ")]),_:1}),o(V).length?(s(),v("div",{key:0,onClick:re},[(s(!0),v(b,null,g(o(V),e=>(s(),m(G,{key:e.webviewPath,src:e.webviewPath},null,8,["src"]))),128))])):w("",!0),t(A,{class:"auto-height modal-img","is-open":U.value,onDidDismiss:l[8]||(l[8]=e=>ne())},{default:a(()=>[X("div",Ge,[X("div",null,[(s(!0),v(b,null,g(o(V),e=>(s(),m(G,{key:e.webviewPath,src:e.webviewPath},null,8,["src"]))),128))])])]),_:1},8,["is-open"])])):w("",!0),t(A,{"is-open":Z.value,onWillDismiss:l[13]||(l[13]=()=>x(!1))},{default:a(()=>[t(z,null,{default:a(()=>[t(B,null,{default:a(()=>[t(H,null,{default:a(()=>[r("Edytuj produkt")]),_:1}),t(y,{slot:"end"},{default:a(()=>[t(O,{onClick:l[9]||(l[9]=e=>x(!1))},{default:a(()=>[r("Close")]),_:1})]),_:1})]),_:1})]),_:1}),t(R,{class:"ion-padding"},{default:a(()=>[t(F,null,{default:a(()=>[t(p,{modelValue:f.value.name,"onUpdate:modelValue":l[10]||(l[10]=e=>f.value.name=e),label:"Nazwa produktu"},null,8,["modelValue"]),t(p,{modelValue:f.value.price,"onUpdate:modelValue":l[11]||(l[11]=e=>f.value.price=e),label:"Cena produktu",type:"number"},null,8,["modelValue"]),t(T,null,{default:a(()=>[t($,{label:"Kategoria","label-placement":"stacked",placeholder:"--- Wybierz kategorię ---",modelValue:f.value.category,"onUpdate:modelValue":l[12]||(l[12]=e=>f.value.category=e)},{default:a(()=>[(s(!0),v(b,null,g(o(N),(e,c)=>(s(),m(E,{key:c,value:e},{default:a(()=>[r(W(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"]),t(A,{"is-open":Y.value,onWillDismiss:l[18]||(l[18]=()=>P(!1))},{default:a(()=>[t(z,null,{default:a(()=>[t(B,null,{default:a(()=>[t(y,{slot:"start"},{default:a(()=>[t(O,{onClick:l[14]||(l[14]=e=>x(!1))},{default:a(()=>[r("anuluj")]),_:1})]),_:1}),t(H,null,{default:a(()=>[r("Nowy produkt")]),_:1}),t(y,{slot:"end"},{default:a(()=>[t(O,{onClick:pe},{default:a(()=>[r("Zapisz")]),_:1})]),_:1})]),_:1})]),_:1}),t(R,{class:"ion-padding"},{default:a(()=>[t(F,null,{default:a(()=>[t(p,{modelValue:i.value.name,"onUpdate:modelValue":l[15]||(l[15]=e=>i.value.name=e),label:"Nazwa produktu"},null,8,["modelValue"]),t(p,{modelValue:i.value.price,"onUpdate:modelValue":l[16]||(l[16]=e=>i.value.price=e),label:"Cena produktu",type:"number"},null,8,["modelValue"]),t(T,null,{default:a(()=>[t($,{label:"Kategoria","label-placement":"stacked",placeholder:"--- Wybierz kategorię ---",modelValue:i.value.category,"onUpdate:modelValue":l[17]||(l[17]=e=>i.value.category=e)},{default:a(()=>[(s(!0),v(b,null,g(o(N),(e,c)=>(s(),m(E,{key:c,value:e},{default:a(()=>[r(W(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"])]),_:1})]),_:1})}}},at=be(He,[["__scopeId","data-v-7a10fca6"]]);export{at as default};
